(this["webpackJsonp@coreui/coreui-pro-react-admin-template"]=this["webpackJsonp@coreui/coreui-pro-react-admin-template"]||[]).push([[61],{1224:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),r=a(56),s=a(20),u=a(676);a(734);t.default=Object(s.i)((function(e){var t=Object(r.d)((function(e){return e.csvFileName})),a=Object(r.d)((function(e){return e.csvDataResult})),s=Object(r.d)((function(e){return e.csvFieldResult}));return console.log("selectorCsvDataResult",a),console.log("csvFieldResult",s),Object(n.useEffect)((function(){}),[a]),void 0===a||null===a?(e.history.push("/inventory-entry/additional-outbound/CSV-upload"),0):o.a.createElement("div",{className:"w-100 d-flex flex-column stock-take-summary"},o.a.createElement(u.b,{columns:s,tableClass:"reviewTable",data:a}),o.a.createElement("div",{className:"row pt-3"},o.a.createElement("div",{className:"col-4"},o.a.createElement("button",{type:"button",className:"btn px-3 mr-3 text no-shadow",style:{backgroundColor:"#fff"},onClick:function(){return e.history.push("/inventory-entry/additional-outbound/CSV-upload")}},"Upload Another File")),o.a.createElement("div",{className:"col-4",style:{lineHeight:"40px"}},"Review your imported file: ",t," (",a.length||0," Lines)")))}))},676:function(e,t,a){"use strict";a.d(t,"b",(function(){return N})),a.d(t,"a",(function(){return k}));var n=a(65),o=a.n(n),r=a(91),s=a(169),u=a(170),i=a(172),d=a(171),l=a(1),c=a.n(l),p=a(660),m=a(707),b=a.n(m),f=(a(677),a(708),a(47)),v=a.n(f),h=a(709),w=a.n(h),k=function(e){Object(i.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).changeOutboundReason=function(e){setTimeout((function(){var t=document.getElementById("row".concat(e,"-outboundReason"));t.classList.add("red","tooltip-custom"),t.innerHTML="Outbound Reason Can't be empty<span class=\"tooltiptext\">Outbound Reason Can't be empty if Outbound type = 'Lainnya'</span>"}),300)},n.changeWarehouseUuid=function(e,t,a,s,u,i,d){var l=n.props,c=l.setCsvDataTmp,p=l.globalData,m=p.findIndex((function(e){return e.id==s})),b=u.indexOf(e);p[m][t]=i[b],p[m][a]=d[b],console.clear(),console.log(e,u),console.log(p),setTimeout(Object(r.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c(p);case 1:case"end":return e.stop()}}),e)}))),400)},n.validatePOSKU=function(){var e=Object(r.a)(o.a.mark((function e(t,a,s){var u,i,d,l,c,p,m;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=n.props,i=u.setCsvDataTmp,d=u.globalData,l=u.setIsValidate,"additional_inbound"!=u.transaction){e.next=3;break}return e.abrupt("return");case 3:c=d,e.prev=4,l(!1),"/stocktake/rowValidationUpload",p=null,m=null,setTimeout(Object(r.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p=document.getElementById("".concat(s)),m=document.getElementById("".concat(s,"span")),null!==p&&void 0!==p){e.next=4;break}return e.abrupt("return",0);case 4:return m.innerHTML="Validating",e.next=7,v()({method:"post",url:"/stocktake/rowValidationUpload",data:{data:[t]}}).then((function(e){var t,n=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data,o=c.findIndex((function(e){return e.id==a}));n[0]&&!0===n[0].isExist?(c[o].wmsPoSkuCode=n[0].wmsPoSkuCode,c[o].wmsPoSkuCodeStatus=!0,c[o].wmsPoSkuCodeReason="PO SKU Code Not Found",c[o].expiryDate=n[0].expiryDate,c[o].inboundDate=n[0].inboundDate,c[o].supplierName=n[0].supplierName,c[o].supplierUuid=n[0].supplierUuid,c[o].uom=n[0].uom,c[o].photos=n[0].photos,p.classList.remove("red"),p.classList.add("hiddenTooltip")):(c[o].wmsPoSkuCodeStatus=!1,c[o].wmsPoSkuCodeReason="PO SKU Code Not Found",c[o].expiryDate="",c[o].inboundDate="",c[o].supplierName="",c[o].supplierUuid="",p.classList.add("red"),p.classList.remove("hiddenTooltip"),m.innerHTML="PO SKU Code Not Found"),i(c)}));case 7:case"end":return e.stop()}}),e)}))),400),e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(4),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t,a,n){return e.apply(this,arguments)}}(),n.validatePOSKUStockTransfer=function(){var e=Object(r.a)(o.a.mark((function e(t,a,s){var u,i,d,l,c,p,m,b;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=n.props,i=u.setCsvDataTmp,d=u.globalData,l=u.setIsValidate,u.transaction,c=d,e.prev=2,l(!1),"/stocktransfer/rowValidationUpload",p=null,m=null,b=[{id:a.id,poSkuCode:t,skuNumber:a.skuNumber,skuUuid:a.skuUuid,warehouseSource:a.warehouseSource,areaSource:a.areaSource,weight:a.qty}],setTimeout(Object(r.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p=document.getElementById("".concat(s)),m=document.getElementById("".concat(s,"span")),null!==p&&void 0!==p){e.next=4;break}return e.abrupt("return",0);case 4:return m.innerHTML="Validating",e.next=7,v()({method:"post",url:"/stocktransfer/rowValidationUpload",data:{data:b}}).then((function(e){var t,n=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data,o=c.findIndex((function(e){return e.id==a.id}));n[0]&&!0===n[0].isExist?(c[o].wmsPoSkuCode=n[0].wmsPoSkuCode,c[o].wmsPoSkuCodeStatus=n[0].isExist,c[o].wmsPoSkuCodeReason=n[0].errorMessage,c[o].expiryDate=n[0].expiryDate,c[o].inboundDate=n[0].inboundDate,c[o].supplierName=n[0].supplierName,c[o].supplierUuid=n[0].supplierUuid,c[o].uom=n[0].uom,c[o].photos=n[0].photos,p.classList.remove("red"),p.classList.add("hiddenTooltip")):(c[o].wmsPoSkuCodeStatus=!1,c[o].wmsPoSkuCodeReason="PO SKU Code Not Found",c[o].expiryDate="",c[o].inboundDate="",c[o].supplierName="",c[o].supplierUuid="",p.classList.add("red"),p.classList.remove("hiddenTooltip"),m.innerHTML="PO SKU Code Not Found"),i(c)}));case 7:case"end":return e.stop()}}),e)}))),400),e.next=14;break;case 11:return e.prev=11,e.t0=e.catch(2),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t,a,n){return e.apply(this,arguments)}}(),n.validateOutbountReason=function(e,t,a){var o=n.props.globalData,r=o.findIndex((function(e){return e.id==t})),s=o[r];""==e&&"LAINNYA"==s.outboundType.toUpperCase()&&n.changeOutboundReason(t)},n.validateOutbountType=function(e,t,a){var o=n.props,r=o.globalData,s=o.setIsValidate,u=r;if(s(!1),"LAINNYA"!==e.toUpperCase())return s(!0),0;var i=u.findIndex((function(e){return e.id==t}));""==u[i].outboundReason&&n.changeOutboundReason(t)},n.validateSKUNumber=function(){var e=Object(r.a)(o.a.mark((function e(t,a,s,u){var i,d,l,c,p,m,b,f;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=n.props,d=i.globalData,l=i.setCsvDataTmp,c=i.setIsValidate,p=i.transaction,m=d,e.prev=2,c(!1),"/oss/skuByNumbers",b=null,f=null,setTimeout(Object(r.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b=document.getElementById("".concat(s)),f=document.getElementById("".concat(s,"span")),null!==b&&void 0!==b){e.next=4;break}return e.abrupt("return",0);case 4:return f.innerHTML="Validating",e.next=7,v()({method:"post",url:"/oss/skuByNumbers",data:{skuList:[t]}}).then((function(e){var n,o=null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.data,r=e.data.isSuccess,s=m.findIndex((function(e){return e.id==a}));!0===r&&o.length>0?(m[s][u]=o[0].skuNumber,m[s][u+"Reason"]=o[0].skuDescription,m[s][u+"Status"]=!0,m[s][u+"Uuid"]=o[0].id,b.classList.remove("red"),b.classList.add("hiddenTooltip"),"skuNumber"==u&&(m[s].skuUuid=o[0].id,m[s].photo=o[0].imageMd),"newGrade"==u&&(m[s].newGradeUom=o[0].uom),"additional_inbound"==p&&(m[s].uom=o[0].uom)):(m[s][u]=t,m[s][u+"Reason"]="SKU Number Not Found",m[s][u+"Status"]=!1,m[s][u+"Uuid"]=null,b.classList.add("red"),b.classList.remove("hiddenTooltip"),f.innerHTML="SKU Number Not Found","skuNumber"==u&&(m[s].skuUuid="",m[s].photo=""),"newGrade"==u&&(m[s].newGradeUom=null),"additional_inbound"==p&&(m[s].uom="")),l(m)}));case 7:case"end":return e.stop()}}),e)}))),400),e.next=13;break;case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,a,n,o){return e.apply(this,arguments)}}(),n.state={validateStatus:!1,validateResult:"Please Wait...",rowCount:0,keyy:0},n}return Object(u.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.columns,n=t.hiddenRows,o=t.tableClass,r=t.warehouseArea,s=t.outboundType,u=t.setCheckingCsv,i=t.globalData,d=t.editable,l=void 0===d||d,m=t.warehousesData,f=void 0===m?[]:m,v=t.transaction,h=this.state,k=(h.validateStatus,h.keyy),N=[],S=[],U=[];if(f){var y;null===f||void 0===f||null===(y=f.data)||void 0===y||y.map((function(e){N.push(e.code),S.push(e.id),U.push(e.name)}))}var C=r.map((function(e){return e.label.toUpperCase()}))||[],g=r.map((function(e){return e.value}))||[],x=s?s.map((function(e){return e.label.toUpperCase()})):[],O=s?s.map((function(e){return e.value})):[],T=a.map((function(t,a){return t.validator=function(a,n,o,r){var s=t.dataField,i=s+"Status",d=s+"Reason",l=!0,c=null,p="row"+n.id+"-"+s;"wmsPoSkuCode"==s&&"stockTransfer"==v?(e.validatePOSKUStockTransfer(a,n,p,s),l=!0):"wmsPoSkuCode"==s&&(e.validatePOSKU(a,n.id,p,s),l=!0),"skuNumber"==s&&(e.validateSKUNumber(a,n.id,p,s),l=!0);var m=["WASTE","SEMI WASTE"];if("newGrade"==s&&"waste"==e.props.transaction?m.includes(a.toUpperCase())?(n.newGradeUuid=a,n.newGradeUom=null):(c="Waste Type not found",h=!1,l=!1):"newGrade"==s&&(m.includes(a.toUpperCase())?(n.newGradeUuid=a,n.newGradeUom=null):parseInt(a)?(l=!0,e.validateSKUNumber(a,n.id,p,s)):""==a?(n.newGradeUuid=null,n.newGradeUom=null,l=!0):(c="Grade Undefined",h=!1,l=!1)),"outboundType"==s&&O.length>0)if(x.includes(a.toUpperCase())){var b=x.indexOf(a.toUpperCase());n.outboundTypeCode=O[b],l=!0,e.validateOutbountType(a,n.id,p)}else l=!1,c="Outbound Type Not Found";if("outboundReason"==s&&e.validateOutbountReason(a,n.id,p),"warehouse"==s&&(N.includes(a)?(l=!0,e.changeWarehouseUuid(a,"warehouseUuid","warehouseName",n.id,N,S,U)):(l=!1,c="Warehouse Not Found")),"warehouseDestination"==s&&(N.includes(a)?(l=!0,e.changeWarehouseUuid(a,"warehouseDestinationUuid","warehouseDestinationName",n.id,N,S,U)):(l=!1,c="Warehouse Not Found"),console.log(l)),"areaName"==s||"areaNameDestination"==s)if(C.includes(a.toUpperCase())){var f=C.indexOf(a.toUpperCase());"areaNameDestination"==s?n.areaDestination=g[f]:n.areaSource=g[f],l=!0}else l=!1,c="Warehouse Area Not Found";"newPack"==s&&(!isNaN(a)?l=!0:(l=!1,c="Pack Should be a number"));var h=null;!1===(h="number"!=t.type||!isNaN(a))&&(c="".concat(t.text," Should be a ").concat(t.type)),"wmsPoSkuCode"==s&&"stockTransfer"==v&&isNaN(a)&&(h=!1,c="".concat(t.text," Should be a number")),setTimeout((function(){console.log(s,v,h)}),3e3);if(["grade","outboundReason","ripenessLevel","newRipeness","reason","expiryDate"].includes(s)&&""===a?(c="",h=!0,l=!0):"grade"==s&&(m.includes(a.toUpperCase())||(c="Waste Type Not Found",h=!1,l=!1)),"ripenessLevel"==s||"newRipeness"==s){[0,1,2,3].includes(parseInt(a))||""==a?(h=!0,l=!0,c="",""==a&&(a="")):(h=!1,l=!1,c="Undefined Ripeness Level")}if("date_indo"==t.type){a.match(/(0[1-9]|[12][0-9]|3[01])[-.](0[1-9]|1[012])[-.](19|20)\d\d/)||""==a?(h=!0,l=!0):(c="Date format must be 'dd-mm-yyyy'",h=!1,l=!1)}if(n[d]=c,l&&h){["wmsPoSkuCode","skuNumber"].includes(s)||(n[i]=!0,u())}return console.clear(),console.log(l,h),console.log("reason",c),{valid:!(!l||!h),message:c}},t.formatter=function(e,a,n){var o=t.dataField,r=o+"Status",s=o+"Reason",u="row"+a.id+"-"+o,i=a[s];return!1===a[r]?(!1,!1,c.a.createElement("div",{id:u,className:"tooltip-custom red"},e,c.a.createElement("span",{id:u+"span",className:"tooltiptext"},i))):c.a.createElement("div",{id:u,className:"tooltip-custom hiddenTooltip"},e,c.a.createElement("span",{id:u+"span",className:"tooltiptext"},i))},t})),E={sortFunc:this.sortFunc,sortCaret:function(e,t){return e?"asc"===e?c.a.createElement("i",{className:"iconU-tableSortingTop ml-2"}):"desc"===e?c.a.createElement("i",{className:"iconU-tableSortingBottom ml-2"}):null:c.a.createElement("i",{className:"iconU-tableSortingNull ml-2"})}};return console.log(i),c.a.createElement(p.e,{className:"table-responsive"},c.a.createElement(b.a,{keyField:"id",data:i,columns:T,sort:E,classes:o||null,cellEdit:!0===l?w()({mode:"click",blurToSave:!0,nonEditableRows:function(){return e.props.dataDoubleRow||[]}}):null,bordered:!1,hiddenRows:n,key:k}))}}]),a}(c.a.Component),N=function(e){Object(i.a)(a,e);var t=Object(d.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var e=this.props,t=e.columns,a=e.tableClass,n=e.data,o=t.map((function(e,t){return e.formatter=function(t,a,n){var o=e.dataField;return"uploadStatus"==o&&"Failed"===a.uploadStatus?c.a.createElement("div",{className:"tooltip-custom red"},t,c.a.createElement("span",{className:"tooltiptext"},a.uploadStatusReason)):"uploadStatus"==o&&"Success"===a.uploadStatus?c.a.createElement("div",{className:"green"},t,c.a.createElement("span",null)):c.a.createElement("div",null,t,c.a.createElement("span",null))},e})),r={sortFunc:this.sortFunc,sortCaret:function(e,t){return e?"asc"===e?c.a.createElement("i",{className:"iconU-tableSortingTop ml-2"}):"desc"===e?c.a.createElement("i",{className:"iconU-tableSortingBottom ml-2"}):null:c.a.createElement("i",{className:"iconU-tableSortingNull ml-2"})}};return c.a.createElement(p.e,{className:"table-responsive"},c.a.createElement(b.a,{keyField:"id",data:n,columns:o,sort:r,classes:a||null,bordered:!1}))}}]),a}(c.a.Component)},677:function(e,t,a){},734:function(e,t,a){}}]);
//# sourceMappingURL=61.774fe15b.chunk.js.map