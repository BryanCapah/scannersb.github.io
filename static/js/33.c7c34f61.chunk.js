(this["webpackJsonp@coreui/coreui-pro-react-admin-template"]=this["webpackJsonp@coreui/coreui-pro-react-admin-template"]||[]).push([[33,9],{1238:function(e,t,a){"use strict";a.r(t);var n=a(659),s=a(1),o=a.n(s),r=a(56),i=a(19),u=(a(682),a(683)),l=a(674),c=(a(731),a(65)),d=a.n(c),m=a(91),p=a(21),f=a(662),v=a(22),b=a.n(v),h=function(e){var t=e.csvData,a=e.csvField,n=e.isShowErrorOnly,s=e.setIsShowErrorOnly,o=e.setIsHiddenRows,r=e.setCheckingCsv,i=[],u=[];t.map((function(e,t){var n=!0,s=t+1;a.map((function(t,a){var s=t.dataField+"Status";!1===e[s]&&(n=!1)})),!1===n?i.includes(s)||i.push(s):u.includes(s)||u.push(s)}));var l=[];if(!0===n){if((l=u.filter((function(e){return!i.includes(e)}))).length==t.length)return 0}else l=[];o(l),s(!n),r(!0)},w=function(e){var t=(new Date).getTime(),a=new Date(t).getMilliseconds(),n=[],s=[],o=e[0].warehouseUuid||"",r=e[0].warehouseDestinationUuid||"";return e.map((function(e,t){n.includes(e.areaSource)||(s.push({id:t,warehouseSource:o,warehouseDestination:r,areaSource:e.areaSource,areaDestination:e.areaSource,list:[],createdAt:a}),n.push(e.areaSource))})),s},y=function(e){var t=[],a=e[0].warehouseUuid||"",n=e[0].warehouseDestinationUuid||"";return e.map((function(e,s){var o=!1;t.map((function(t,a){t&&t.skuUuid==e.skuUuid&&t.warehouseSource==e.warehouseSource&&t.warehouseDestination==e.warehouseDestinationUuid&&t.areaSource==e.areaSource&&(o=!0)})),o||t.push({warehouseSource:a,warehouseDestination:n,areaSource:e.areaSource,skuUuid:e.skuUuid,skuNumber:e.skuNumber,unitOfMeassures:e.uom,photo:e.photos,poList:[]})})),t},g=function(e,t){var a=[],n=e[0].warehouseUuid||"",s=e[0].warehouseDestinationUuid||"";return e.map((function(e,t){var o=!1,r="";console.log(e);var i=function(e){if(e)return"SEMI WASTE"==e.toUpperCase()?"semi_waste":"WASTE"==e.toUpperCase()?"waste":e}(e.newGradeUuid);i||(i=e.skuUuid),a.map((function(t,a){t&&t.areaSource==e.areaSource&&t.warehouseSource==e.warehouseSource&&t.warehouseDestination==e.warehouseDestination&&t.skuUuid==e.skuUuid&&t.wmsPoSkuCode==e.wmsPoSkuCode&&t.ripenessLevel==e.ripenessLevel&&t.expiryDateCol==e.expiryDateCol&&(o=!0,r=a)})),o||(a.push({skuUuid:e.skuUuid||"",areaSource:e.areaSource||"",warehouseSource:n||"",warehouseDestination:s||"",expiryDateText:e.expiryDateCol||"",expiryDate:b()(e.expiryDateCol,"DD-MM-YYYY").toDate().getTime()||"",inboundDate:e.inboundDate||"",supplierId:e.supplierUuid||"",supplierName:e.supplierName||"",wmsPoSkuCode:e.wmsPoSkuCode||"",codeGrade:e.skuUuid||"",ripenessLevel:e.ripenessLevel||0,skuNumber:e.skuNumber||"",areaName:e.areaName||"",warehouseCode:e.warehouseCode||"",itemList:[]}),r=a.length-1),a[r].itemList.push({qty:e.qty||0,areaSource:e.areaSource,skuNumber:e.skuNumber,ripeness:{label:e.ripenessLevel||"",value:e.ripenessLevel||0},expiryDate:b()(e.expiryDateCol,"DD-MM-YYYY").toDate().getTime()||"",expiryDateText:e.expiryDateCol,grade:{label:e.newGrade,value:i||e.skuUuid},codeOutbound:{label:e.outboundTypeCode||"",value:e.outboundTypeCode||""},note:e.reason||"",areaName:e.areaName||"",pack:e.inputPack||0,unitOfMeassures:e.uom||"",warehouseCodeSource:e.warehouse||"",warehouseCodeDestination:e.warehouseDestination||""})})),a},S=function(e,t,a){return t.map((function(e,n){a.map((function(a,s){a&&a.areaSource==e.areaSource&&a.warehouseSource==e.warehouseSource&&a.warehouseDestination==e.warehouseDestination&&a.skuUuid==e.skuUuid&&t[n].poList.push(a)}))})),e.map((function(n,s){t.map((function(t,o){a&&n.areaSource==t.areaSource&&n.warehouseSource==t.warehouseSource&&n.warehouseDestination==t.warehouseDestination&&e[s].list.push(t)}))})),e},x=function(e){var t=[],a=1;return e.list.map((function(e,n){e.poList.map((function(e,n){e.wmsPoSkuCode,e.ripenessLevel;e.itemList.map((function(n,s){var o,r="Failed";n.isSuccess&&(r="Success"),t.push({id:a,uploadStatus:r||"",uploadStatusReason:n.message,wmsPoSkuCode:e.wmsPoSkuCode||"",skuNumber:n.skuNumber||"",ripenessLevel:(null===(o=n.ripeness)||void 0===o?void 0:o.label)||"",qty:n.qty||0,reason:n.note||"",grade:e.codeGrade||"",areaName:n.areaName||"",warehouse:n.warehouseCodeSource||"",areaNameDestination:n.areaNameDestination||"",warehouseDestination:n.warehouseCodeDestination||"",expiryDateCol:n.expiryDateText||""}),a++}))}))})),t},N=function(){var e=Object(m.a)(d.a.mark((function e(t){var a,n,s,o,r,i,u,l,c,m,v,b,h,N,k,C,E,O;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.csvData,n=t.dispatch,s=t.csvField,o=t.setIsSubmitText,r=t.setSubmitStatus,i=t.setIsShowModal,u=t.setMsg2,console.log(a),o("Loading..."),e.next=5,w(a);case 5:return l=e.sent,c=a[0].warehouseName||"Warehouse",m=a[0].areaName||"Area",v=a[0].warehouseDestinationName||"Warehouse Destination",e.next=11,y(a);case 11:return b=e.sent,e.next=14,g(a);case 14:return h=e.sent,e.next=17,S(l,b,h);case 17:return N=e.sent,e.next=20,Object(f.q)({dataCsv:N,setSubmitStatus:r,dispatch:n,transaction:"stock-transfer"});case 20:if(k=e.sent,i(!1),o("Submit"),1!=(null===k||void 0===k?void 0:k.isSuccess)){e.next=28;break}u([{className:"h5 font-weight-bold",message:"PO SKU Code: ".concat(null===k||void 0===k||null===(C=k.data)||void 0===C?void 0:C.poNumber)},{className:"h5 green mt-4",message:"".concat(c," (").concat(m,") to ").concat(v," - ").concat((null===b||void 0===b?void 0:b.length)||0," SKU(s).")}]),r("success"),e.next=45;break;case 28:if(0!=(null===k||void 0===k?void 0:k.isSuccess)||!(null===k||void 0===k?void 0:k.jobPost)){e.next=43;break}return u([{className:"h5 font-weight-bold",message:"Failed to proceed because we can't match some of data."},{className:"h5 green mt-3",message:"Try to fix the error part and try again."}]),r("noData"),e.next=33,x((null===k||void 0===k?void 0:k.jobPost)||[]);case 33:return E=e.sent,e.next=36,n({type:p.l,csvDataResult:E});case 36:return(O=[]).push({dataField:"uploadStatus",text:"Upload Status",type:"string",sort:!0}),s.map((function(e,t){O.push(e)})),e.next=41,n({type:p.l,csvFieldResult:O});case 41:e.next=45;break;case 43:u("400 - Failed to proceed."),r("API");case 45:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=a(660),C=(a(663),a(116),function(e){var t=e.isSaved,a=(e.setIsSaved,e.confirmation,e.submit,e.statusDisplay),n=void 0!==a&&a,s=e.title,r=void 0===s?"":s,i=e.cancelButtonTitle,u=void 0===i?"Cancel":i,l=e.actionButtonTitle,c=void 0===l?"Submit":l,d=e.cancelButtonClass,m=void 0===d?"bg-background":d,p=e.actionButtonClass,f=void 0===p?"bg-background":p,v=e.actionButtonEvent,b=void 0===v?null:v,h=e.msg1,w=void 0===h?null:h,y=e.msg2,g=void 0===y?null:y,S=(e.setShow,e.onCloseFunction),x={success:{headerIcon:"em em-tada",textColor:"green",button:"bg-green"},failed:{headerIcon:"em em-anguished",textColor:"red",button:"bg-red"}},N="success"==t?x.success:x.failed,C=document.getElementById("btn_is_saved");return C&&C.focus(),o.a.createElement(k.B,{className:n?null:"d-none"},o.a.createElement(k.f,null,o.a.createElement(k.s,{show:n,onClose:function(){S()},size:"lg",style:{minHeight:"280px"},bodyOpenClassName:"p-3",closeOnBackdrop:!1},o.a.createElement("div",{className:"d-flex flex-row-reverse"},o.a.createElement("i",{className:"pr-3 pt-3 iconU-modalClose",onClick:function(){S()}})),o.a.createElement(k.t,{className:"px-5 mt-3 py-0"},o.a.createElement("label",{className:"".concat(N.textColor," LatoBold mr-2 h5 mb-3")},r)," ",o.a.createElement("span",null,o.a.createElement("i",{className:"".concat(N.headerIcon)})),o.a.createElement("div",{className:"mr-1 h5 mb-3"},"".concat(w)),o.a.createElement("div",{style:{backgroundColor:"#F5F7FA"},className:"w-100 border rounded px-3 pt-4 pb-3 mb-4"},Array.isArray(g)?g.map((function(e,t){return o.a.createElement("div",{className:e.className}," ",e.message," ")})):o.a.createElement("div",{className:"h5 font-weight-bold"},g))),o.a.createElement(k.u,{className:"px-5 pb-5 pt-0 justify-content-start border-none"},u?o.a.createElement(k.d,{className:"".concat(m," no-shadow px-5 mt-4 mb-0 mx-0"),onClick:function(){S()}},u):null,c?o.a.createElement(k.d,{className:"".concat(f," text no-shadow px-5 mt-4 mb-0 ml-3 mr-0"),onClick:function(){b()}},c):null," "))))});a(666),t.default=Object(i.i)((function(e){var t=Object(r.c)(),a=Object(r.d)((function(e){return e.csvFileName})),i=Object(r.d)((function(e){return e.csvData})),c=Object(r.d)((function(e){return e.csvField})),d=Object(r.d)((function(e){return e.warehouseAreaCsv})),m=Object(r.d)((function(e){return e.status})),f=Object(r.d)((function(e){return e.warehouseData})),v=o.a.useState(!1),b=Object(n.a)(v,2),w=b[0],y=b[1],g=o.a.useState(null),S=Object(n.a)(g,2),x=S[0],k=S[1],E=o.a.useState(!0),O=Object(n.a)(E,2),D=O[0],F=O[1],U=o.a.useState(!1),j=Object(n.a)(U,2),T=j[0],I=j[1],P=o.a.useState(!1),A=Object(n.a)(P,2),B=A[0],R=A[1],L=o.a.useState(!0),G=Object(n.a)(L,2),W=G[0],M=G[1],V=o.a.useState(!1),K=Object(n.a)(V,2),q=K[0],H=K[1],Y=o.a.useState(null),_=Object(n.a)(Y,2),X=_[0],z=_[1],J=o.a.useState(null),Q=Object(n.a)(J,2),Z=Q[0],$=Q[1],ee=o.a.useState(null),te=Object(n.a)(ee,2),ae=te[0],ne=te[1],se=o.a.useState(null),oe=Object(n.a)(se,2),re=oe[0],ie=oe[1],ue=o.a.useState(null),le=Object(n.a)(ue,2),ce=le[0],de=le[1],me=o.a.useState("Submit"),pe=Object(n.a)(me,2),fe=pe[0],ve=pe[1],be=o.a.useState(null),he=Object(n.a)(be,2),we=he[0],ye=he[1],ge=o.a.useState(null),Se=Object(n.a)(ge,2),xe=Se[0],Ne=Se[1],ke=o.a.useState(null),Ce=Object(n.a)(ke,2),Ee=Ce[0],Oe=Ce[1];if(Object(s.useEffect)((function(){!function(e){var t=e.csvData,a=e.csvField,n=e.setIsValidate,s=e.setCheckingCsv;if(void 0===t)return 0;var o=!0;t.map((function(e,t){a.map((function(t,a){var n=e[t.dataField+"Status"];"outboundType"==t.dataField&&("LAINNYA"==e[t.dataField].toUpperCase()&&""==e.outboundReason&&(n=!1));!1===n&&(o=!1)}))})),n(!1!==o),s(!1)}({csvData:i,csvField:c,setIsValidate:I,setCheckingCsv:M})}),[W]),Object(s.useEffect)((function(){"success"==q?(z("Success!"),$(a+" upload successfull."),ie("Cancel"),de("Select Again"),Ne("bg-green background"),Oe("green"),R(!0)):"API"==q?(z("Failed!"),$(a+" failed to upload."),ie("Cancel"),de("Retry"),Ne("bg-red background"),Oe("red"),R(!0)):"noData"==q&&(z("Failed!"),$(a+" failed to upload."),ie("Check"),ye("bg-red background"),Ne("d-none"),Oe("red"),R(!0))}),[q]),void 0===i||null===i)return e.history.push("/inventory-entry/stock-transfer/CSV-upload"),0;var De=function(e){!function(e){var t=e.param,a=e.dispatch,n=e.setCheckingCsv;a({type:p.l,csvData:t}),n(!0)}({param:e,dispatch:t,setCheckingCsv:M}),h({csvData:i,csvField:c,isShowErrorOnly:!1,setIsShowErrorOnly:F,setIsHiddenRows:k,setCheckingCsv:M})};return o.a.createElement("div",{className:"w-100 d-flex flex-column stock-take-summary"},o.a.createElement(u.a,{globalData:i,columns:c,tableClass:"reviewTable",hiddenRows:x,warehouseArea:d,setCsvDataTmp:function(e){return De(e)},setIsValidate:function(e){return I(e)},dispatch:t,setCheckingCsv:M,warehousesData:f}),o.a.createElement("div",{className:"row pt-3"},o.a.createElement("div",{className:"col-4"},o.a.createElement("button",{type:"button",className:"btn px-3 mr-3 text no-shadow",style:{backgroundColor:"#fff"},onClick:function(){return h({csvData:i,csvField:c,isShowErrorOnly:D,setIsShowErrorOnly:F,setIsHiddenRows:k,setCheckingCsv:M})}},"Show ",D?"Errors Only":"All"),o.a.createElement("button",{type:"button",className:"btn px-3 mr-3  text no-shadow",style:{backgroundColor:"#fff"},onClick:function(){return function(e){var t=e.csvData,a=e.csvField,n=e.dispatch,s=e.setCheckingCsv,o=[];t.map((function(e,t){var n=!0;a.map((function(t,a){var s=t.dataField+"Status";!1===e[s]&&(n=!1)})),!0===n&&o.push(e)})),n({type:p.l,csvData:o}),s(!0)}({csvData:i,csvField:c,dispatch:t,setCheckingCsv:M})}},"Delete Errors Field")),o.a.createElement("div",{className:"col-4",style:{lineHeight:"40px"}},"Review your imported file: ",a," (",i.length||0," Lines)"),o.a.createElement("div",{className:"col-4"},o.a.createElement("button",{type:"button",className:"btn px-5 bg-red text-white no-shadow float-right",onClick:function(){return e.history.goBack()}},"Discard"),o.a.createElement("button",{type:"button",class:"btn px-5 mr-3 text-white no-shadow float-right "+(!0===T&&(null===i||void 0===i?void 0:i.length)>0?"bg-green":"bg-primaryGrey disabled"),onClick:function(){return y(!w)}},"Submit"))),o.a.createElement(C,{isSaved:q,status:m,onCloseFunction:function(){R(!1),H(!1),"success"==q?e.history.push("/inventory-entry/stock-transfer"):"noData"==q&&e.history.push("/inventory-entry/stock-transfer/CSV-upload/result")},statusDisplay:B,title:X,cancelButtonTitle:re,actionButtonTitle:ce,colorText:Ee,refreshOnCancel:!1,msg1:Z,msg2:ae,cancelButtonClass:we,actionButtonClass:xe+" ml-0",actionButtonEvent:function(){("success"==q||"API"==q)&&e.history.push("/inventory-entry/stock-transfer/CSV-upload")}}),o.a.createElement(l.a,{submit:function(){return N({dispatch:t,csvData:i,csvField:c,setIsShowModal:y,setIsSubmitText:ve,setSubmitStatus:H,setMsg1:$,setMsg2:ne})},submitText:fe,show:w,setIsShowModal:y}))}))},663:function(e,t,a){},666:function(e,t,a){"use strict";var n=a(659),s=a(1),o=a.n(s),r=a(660),i=(a(663),a(56)),u=a(21);t.a=function(e){var t=e.refresh,a=e.status,l=e.icon,c=e.statusDisplay,d=void 0!==c&&c,m=e.title,p=void 0===m?"":m,f=e.cancelButtonTitle,v=void 0===f?"Cancel":f,b=e.actionButtonTitle,h=void 0===b?"Submit":b,w=e.cancelButtonClass,y=void 0===w?"bg-background":w,g=e.actionButtonClass,S=void 0===g?"bg-background":g,x=e.actionButtonEvent,N=void 0===x?null:x,k=e.colorText,C=void 0===k?"red":k,E=e.msg1,O=void 0===E?null:E,D=e.msg2,F=void 0===D?null:D,U=e.onCloseFunction,j=void 0===U?null:U,T=e.refreshOnCancel,I=void 0===T||T,P=e.setIsSuccess,A=Object(i.c)();500===(null===a||void 0===a?void 0:a.code)&&0==d&&(l="em-pensive",p="Server Error",v="Try Again",h="Contact Administration",C="red",O=null===a||void 0===a?void 0:a.message,F="Please try again or contact Sayurbox administration for further information.",y="bg-green",d=!0,I=!0),408===(null===a||void 0===a?void 0:a.code)&&0==d&&(l="em-alarm_clock",p="Request Timeout",v="Try Again",h="Contact Administration",C="red",O=null===a||void 0===a?void 0:a.message,F="Please try again or contact Sayurbox administration for further information.",y="bg-green",d=!0,I=!0),400===(null===a||void 0===a?void 0:a.code)&&0==d&&(l="em-alarm_clock",p="Server Error",v="Try Again",h="Contact Administration",C="red",O=null===a||void 0===a?void 0:a.message,F="Please try again or contact Sayurbox administration for further information.",y="bg-green",d=!0,I=!1),404===(null===a||void 0===a?void 0:a.code)&&(p="Something wrong with the application",v="Try Again",h="Contact Administration",C="red",O=null===a||void 0===a?void 0:a.message,F="Please try again or contact Sayurbox administration for further information.",y="bg-green",d=!0,I=!1);var B=Object(s.useState)(d),R=Object(n.a)(B,2),L=R[0],G=R[1];return Object(s.useEffect)((function(){G(d)}),[d]),Object(s.useEffect)((function(){}),[L]),window.onkeydown=function(e){return 27===e.keyCode?G(!1):null},o.a.createElement(r.B,{className:"".concat(L?null:"d-none")},o.a.createElement(r.f,null,o.a.createElement(r.s,{show:L,closeOnBackdrop:!1,onClose:function(){G(!1),"function"===typeof P&&P({success:null,name:null}),A({type:u.k,status:null}),j&&j()},size:"lg",style:{minHeight:"280px"},bodyOpenClassName:"p-3"},o.a.createElement("div",{className:"d-flex flex-row-reverse"},o.a.createElement("i",{className:"pr-3 pt-3 iconU-modalClose",onClick:function(){G(!1),"function"===typeof P&&P({success:null,name:null}),A({type:u.k,status:null}),j&&j()}})),o.a.createElement(r.v,{className:"px-5 pt-5 border-none"},o.a.createElement(r.w,{className:"text LatoBold ".concat(C)},p," ",o.a.createElement("span",null,o.a.createElement("i",{className:"em ".concat(l)})))),o.a.createElement(r.t,{className:"px-5 py-0"},o.a.createElement("p",{className:"text mb-2"},O),o.a.createElement("p",{className:"text"},F)),o.a.createElement(r.u,{className:"px-5 pb-5 pt-0 justify-content-start border-none"},v?o.a.createElement(r.d,{className:"".concat(y," no-shadow px-5 mt-4 mb-0 mx-0"),onClick:function(){I?"function"===typeof t?t():function(e){var t=e.refresh;!0===(void 0===t||t)&&window.location.reload(!1)}({refresh:!0}):function(e){var t=e.setShow,a=e.parentOncCloseFunction;t(!1),a&&a()}({setShow:G,parentOncCloseFunction:j}),A({type:u.k,status:null})}},v):null,h?o.a.createElement(r.d,{className:"".concat(S," text no-shadow px-5 mt-4 mb-0 ml-3 mr-0"),onClick:function(){N?(N(),G(!1)):G(!1)}},h):null," "))))}},668:function(e,t,a){},674:function(e,t,a){"use strict";a.d(t,"b",(function(){return m})),a.d(t,"a",(function(){return p}));var n=a(659),s=a(1),o=a.n(s),r=a(660),i=(a(668),a(56)),u=a(665),l=a(694),c=function(e){var t=e.e,a=e.state,n=e.isCaptcha,s=e.setIsValidated,o=e.setIsType,r=e.isType,i=t.key;if(["ArrowRight","ArrowLeft","ArrowUp","ArrowDown","Tab"].includes(i))return 0;"Backspace"===i?1!==a&&document.getElementById("t"+(parseInt(a)-1)).focus():3!==a&&document.getElementById("t"+(parseInt(a)+1)).focus();var l=Object(u.a)(r);l[a]="Backspace"===i?"":i.toUpperCase();if(!"QWERTYUIOPLKJHGFDSAZXCVBNM1234567890".split("").includes(i.toUpperCase())&&""!=l[a])return 0;document.getElementById("t"+parseInt(a)).value=l[a],o(l);var c=!0;n.map((function(e,t){0!=t&&l[t+1]!=n[t]&&(c=!1)})),s(c)},d=a(664),m=function(e){var t,a,n,i=e.moduleEntry,u=e.confirmation,c=e.setConfirmation,m=e.save,p=e.submit,f=e.isSuccess,v=e.isLoading,b=e.moveAll,h=e.setAction,w=e.moduleName,y=e.noSkuChecking,g=e.singleViewData,S=document.documentElement.clientHeight-300,x="Submit";"save"===u.name&&(x="Save"),Object(s.useEffect)((function(){f&&c({show:!1,name:null})}),[f]),window.onkeydown=function(e){return 27===e.keyCode?c({show:!1,name:null}):null},Object(s.useEffect)((function(){h(u.name)}),[u]);var N=g&&!b?g:i,k=null===N||void 0===N||null===(t=N.jobPost)||void 0===t?void 0:t.areaDestinationName,C=null===N||void 0===N||null===(a=N.jobPost)||void 0===a?void 0:a.warehouseDestinationName,E=null===N||void 0===N||null===(n=N.jobPost)||void 0===n?void 0:n.areaName,O=function(e,t,a){if(null===e||void 0===e?void 0:e.length){var n=[];e.map((function(e){e.poList.map((function(s){s.itemList.map((function(s){var o,r,i,u,c,d,m=s.qty,p=s.grade,f=Object(l.a)(m)?parseInt(m):m?parseFloat(m):0,v=t?e.skuName:"waste"===a?(null===(o=s.wasteType)||void 0===o?void 0:o.label)?null===(r=s.wasteType)||void 0===r?void 0:r.label:e.skuName:null===p||void 0===p?void 0:p.label,b="waste"===a?"Semi Waste"===(null===(i=s.wasteType)||void 0===i?void 0:i.label)||"Waste"===(null===(u=s.wasteType)||void 0===u?void 0:u.label):"Waste"===(null===p||void 0===p?void 0:p.label)||"Semi Waste"===(null===p||void 0===p?void 0:p.label),h=t?e.unitOfMeassures:"gram"===(null===p||void 0===p?void 0:p.uom)?"kg":null===p||void 0===p?void 0:p.uom,w={sku:v,qty:f,uom:h,wqty:0,swqty:0};b&&(w.qty=0,w.sku=e.skuName),("waste"===a?"Waste"===(null===(c=s.wasteType)||void 0===c?void 0:c.label):"Waste"===(null===p||void 0===p?void 0:p.label))&&(w.wqty=f),("waste"===a?"Semi Waste"===(null===(d=s.wasteType)||void 0===d?void 0:d.label):"Semi Waste"===(null===p||void 0===p?void 0:p.label))&&(w.swqty=f);var y,g,S=n.findIndex((function(t){return(null===t||void 0===t?void 0:t.sku)===(b?e.skuName:v)}));("waste"!==a&&(-1===S&&n.push(w),-1!==S&&(b||(n[S].qty+=f),"Semi Waste"===(null===p||void 0===p?void 0:p.label)&&(n[S].swqty+=f),"Waste"===(null===p||void 0===p?void 0:p.label)&&(n[S].wqty+=f))),"waste"===a)&&(-1===S&&n.push(w),-1!==S&&(b||(n[S].qty+=f),"Semi Waste"===(null===(y=s.wasteType)||void 0===y?void 0:y.label)&&(n[S].swqty+=f),"Waste"===(null===(g=s.wasteType)||void 0===g?void 0:g.label)&&(n[S].wqty+=f)))}))}))}));var s=e.length?e[0].skuName:"No SKU",o=n.findIndex((function(e){return e.sku===s}));return n.map((function(e){-1!==o&&("Waste"===e.sku&&(n[o].wqty=e.qty),"Semi Waste"===e.sku&&(n[o].swqty=e.qty))})),n}}(null===N||void 0===N?void 0:N.jobPost.list,y,w);return o.a.createElement(r.B,{className:u.show?null:"d-none"},o.a.createElement(r.f,null,o.a.createElement(r.s,{show:u.show,closeOnBackdrop:!1},o.a.createElement(r.v,{className:"px-4 pt-5 border-none"},o.a.createElement(r.w,{className:"text LatoBold"},"Confirmation ",o.a.createElement("span",null,o.a.createElement("i",{className:"em em-pray"}))),o.a.createElement("label",{tabIndex:"0",onKeyDown:function(e){return 13===e.keyCode&&c({show:!1,name:null})},onClick:function(){return c({show:!1,name:null})},className:"sku-item iconU-modalClose"})),o.a.createElement(r.t,{className:"px-4 py-0",style:{minHeight:S}},o.a.createElement("p",{className:"text mb-2"},o.a.createElement("span",null,"Are you sure want to ".concat("Waste"==E?"update":"send"," this Item ")),o.a.createElement("span",{className:" ".concat(k?null:"d-none")}," from"),o.a.createElement("span",{className:"green ".concat(k?null:"d-none")}," ".concat(E," ")),o.a.createElement("span",null,"outbound"==w?"from":"repack"===w?"":"to"," "),o.a.createElement("span",{className:"green ".concat("repack"!==w?null:"d-none")}," ".concat("stockTransfer"===w?C:k||E," "))),o.a.createElement("p",{className:"text"},"Please double check this list, this record will store to database."),o.a.createElement("div",{style:{minHeight:S,maxHeight:S,overflow:"auto",border:"1px solid var(--lineGrey)"}},o.a.createElement("table",null,o.a.createElement("thead",null,o.a.createElement("tr",{style:{borderBottom:"1px solid var(--lineGrey)"}},o.a.createElement("th",{style:{color:"var(--emptyTextField)"}},"SKU List"),o.a.createElement("th",{style:{textAlign:"right",color:"var(--emptyTextField)"}},"Weight"),o.a.createElement("th",{style:{textAlign:"right",color:"var(--emptyTextField)"}},"Semi Waste"),o.a.createElement("th",{style:{textAlign:"right",color:"var(--emptyTextField)"}},"Waste"))),o.a.createElement("tbody",null,null===O||void 0===O?void 0:O.map((function(e){return o.a.createElement("tr",{style:{borderBottom:"1px solid var(--lineGrey)"}},o.a.createElement("td",{style:{maxWidth:"160px"}},e.sku),o.a.createElement("td",{className:"text-right py-3",style:{textAlign:"right"}},"".concat(Object(d.s)(null===e||void 0===e?void 0:e.qty))),o.a.createElement("td",{className:"text-right text-nowrap",style:{textAlign:"right"}},o.a.createElement("span",{className:"text-nowrap"},"".concat(Object(d.s)(null===e||void 0===e?void 0:e.swqty)," "))),o.a.createElement("td",{className:"text-right",style:{textAlign:"right"}},"".concat(Object(d.s)(null===e||void 0===e?void 0:e.wqty))))}))))),o.a.createElement("div",{className:"px-0 pb-5 pt-0 justify-content-start border-none"},o.a.createElement(r.d,{tabIndex:"0",onKeyDown:function(e){return 13===e.keyCode&&c({show:!1,name:null})},className:"bg-background sku-item text no-shadow px-5 mt-4 mb-0 mx-0",onClick:function(){return c({show:!1,name:null})}},"Cancel"),o.a.createElement(r.d,{tabIndex:"0",onKeyDown:function(e){return 13===e.keyCode&&(v?null:"save"===u.name?m():p())},className:"".concat(v?"bg-softGreen text":"bg-green text-white"," no-shadow px-5 mt-4 sku-item mb-0 ml-3 mr-0"),onClick:function(){return v?null:"save"===u.name?m():p()}},v?"Processing...":x)," ")))))},p=function(e){for(var t=e.show,a=void 0!==t&&t,u=e.setIsShowModal,l=e.submit,d=e.submitText,m=void 0===d?"Submit":d,p="",f="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",v=f.length,b=[],h=0;h<3;h++){var w=f.charAt(Math.floor(Math.random()*v));p+=w,b.push(w)}Object(i.c)();var y=Object(i.d)((function(e){return e.csvFileName})),g=o.a.useState(b),S=Object(n.a)(g,2),x=S[0],N=(S[1],o.a.useState(p)),k=Object(n.a)(N,2),C=k[0],E=(k[1],o.a.useState(!1)),O=Object(n.a)(E,2),D=O[0],F=O[1],U=o.a.useState("Submit"),j=Object(n.a)(U,2),T=(j[0],j[1],o.a.useState([])),I=Object(n.a)(T,2),P=I[0],A=I[1];return Object(s.useEffect)((function(){!0===a&&(document.getElementById("t1").value="",document.getElementById("t2").value="",document.getElementById("t3").value="")}),[a]),o.a.createElement(r.B,{className:a?null:"d-none"},o.a.createElement(r.f,null,o.a.createElement(r.s,{show:a,onClose:function(){u(!1)},size:"lg",style:{height:"400px"}},o.a.createElement(r.v,{className:"px-5 pt-5 border-none"},o.a.createElement(r.w,{className:"text LatoBold"},"Confirmation")),o.a.createElement(r.t,{className:"px-5 py-0"},o.a.createElement("p",{className:"text mb-2"},"Are you sure want to upload ",o.a.createElement("span",{className:"green"},"Edited")," ",y,"?"),o.a.createElement("p",{className:"text"},"Once uploaded this record will store to databases."),o.a.createElement("p",{className:"text mb-2"},"Please type \u2018",C,"\u2019 on the Box to confirm upload file."),o.a.createElement("div",{className:"captcha-box"},o.a.createElement("input",{autocomplete:"off",onKeyUp:function(e){c({e:e,state:1,isCaptcha:x,setIsValidated:F,setIsType:A,isType:P})},id:"t1",type:"text",style:{textTransform:"uppercase"},className:"captcha-input",maxLength:"1",placeholder:x[0]}),o.a.createElement("input",{autocomplete:"off",onKeyUp:function(e){c({e:e,state:2,isCaptcha:x,setIsValidated:F,setIsType:A,isType:P})},id:"t2",type:"text",style:{textTransform:"uppercase"},className:"captcha-input ml-0 mr-0",maxLength:"1",placeholder:x[1]}),o.a.createElement("input",{autocomplete:"off",onKeyUp:function(e){c({e:e,state:3,isCaptcha:x,setIsValidated:F,setIsType:A,isType:P})},id:"t3",type:"text",style:{textTransform:"uppercase"},className:"captcha-input",maxLength:"1",placeholder:x[2]}))),o.a.createElement(r.u,{className:"px-5 pb-5 pt-0 justify-content-start border-none"},o.a.createElement(r.d,{className:"bg-background text no-shadow px-5 mt-4 mb-0 mx-0",onClick:function(){u(!1)}},"Cancel"),o.a.createElement(r.d,{className:(D?"bg-green":"bg-emptyTextField disabled")+" no-shadow px-5 mt-4 mb-0 ml-3 mr-0",onClick:function(){l(),F(!1)}},m)," "))))}},677:function(e,t,a){"use strict";a.d(t,"e",(function(){return d})),a.d(t,"b",(function(){return m})),a.d(t,"g",(function(){return p})),a.d(t,"c",(function(){return f})),a.d(t,"f",(function(){return v})),a.d(t,"a",(function(){return b})),a.d(t,"d",(function(){return h}));var n=a(4),s=a(65),o=a.n(s),r=a(91),i=a(705),u=a.n(i),l=a(708),c=a(21),d=function(){document.getElementById("download-template-xls").click()},m=function(e,t,a){return new Promise((function(n,s){var o=0,r=[],i=new FileReader;i.onload=function(){u.a.parse(i.result,(function(e,s){s.length>2001&&(a(0),n(!1)),s.map((function(e,n){if(0===n)return o++,!1;var i={};i.id=n,s[o].toString().split(";").map((function(e,a){i[t[a+1]]=e})),o++,r.push(i);var u=25*(n+1)/s.length;a(Math.ceil(u))}))}))},setTimeout((function(){n(r)}),200),i.readAsBinaryString(e[0])}))},p=function(){var e=Object(r.a)(o.a.mark((function e(t,a,n,s,i){var c,d,m,p;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=0,d=[],m=new FileReader,p=null,!1,e.abrupt("return",new Promise((function(e,s){new FileReader;m.onload=function(){var t=Object(r.a)(o.a.mark((function t(s){var r,i,m,f;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.target.result,i=l.read(r,{type:"binary"}),m=i.SheetNames[0],f=i.Sheets[m],p=l.utils.sheet_to_csv(f,{header:1}),t.next=7,u.a.parse(p,(function(t,s){s.length>2001&&(n(0),e(!1)),s.map((function(e,t){var o={};o.id=t,s[c].toString().split(",").map((function(e,t){o[a[t+1]]=e})),c++,d.push(o);var r=25*(t+1)/s.length;n(Math.ceil(r))}))}));case 7:setTimeout((function(){e(d)}),200);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),m.readAsBinaryString(t[0])})));case 6:case"end":return e.stop()}}),e)})));return function(t,a,n,s,o){return e.apply(this,arguments)}}(),f=function(e){var t=e.dispatch,a=e.jsonArray;t({type:c.l,csvField:a})},v=function(){var e=Object(r.a)(o.a.mark((function e(t){var a,n,s,r,i,u,l,d,m,p,f,v,b,h,w,y,g,S,x,N,k,C,E,O,D,F,U;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.field,n=t.jsonArray,s=t.setIsProgressPercent,r=t.fileName,i=t.dispatch,u=t.warehouseArea,l=t.warehouseUuid,d=t.outboundType,m=t.setIsCheckingSchema,p=t.setIsCheckingArea,f=t.warehousesData,v=[],b=[],h=[],f&&f.data.map((function(e){v.push(e.code),b.push(e.id),h.push(e.name)})),w=u?u.map((function(e){return e.label.toUpperCase()})):[],y=u?u.map((function(e){return e.value})):[],g=d?d.map((function(e){return e.label.toUpperCase()})):[],S=d?d.map((function(e){return e.value})):[],x=a?a.map((function(e){return e.text.toUpperCase().replace(/\s/g,"")})):[],N=[],k=[],C=[],E=[],!0,O=0,D=n[0],e.t0=o.a.keys(D);case 18:if((e.t1=e.t0()).done){e.next=34;break}if("id"!=(F=e.t1.value)){e.next=22;break}return e.abrupt("continue",18);case 22:if(U=D[F].toUpperCase().replace(/\s/g,""),"undefined"===F||x[O+1]===U&&x.includes(U)){e.next=31;break}return console.clear(),console.log("--Schema Not Same--"),console.log("Schema \t\t: ",x[O+1]),console.log("File SChema : ",U),!1,m(!1),e.abrupt("return",0);case 31:O++,e.next=18;break;case 34:return n.shift(),e.next=37,n.map((function(e,t){var o=!0;a.map((function(a,r){if(void 0!==a&&null!==a&&("id"===a.dataField||""!=e[a.dataField])){if("id"==a.dataField||(o=!1),e.warehouseSource=l,v&&"warehouse"==a.dataField){if(!v.includes(e[a.dataField]))return e[a.dataField+"Status"]=!1,e[a.dataField+"Reason"]="Warehouse Not Found",e.warehouseUuid="",void(e.warehouseName="");var i=v.indexOf(e[a.dataField]);e.warehouseUuid=b[i],e.warehouseName=h[i]}if(v&&"warehouseDestination"==a.dataField){if(!v.includes(e[a.dataField]))return e[a.dataField+"Status"]=!1,e[a.dataField+"Reason"]="Warehouse Not Found",e.warehouseDestinationUuid="",void(e.warehouseDestinationName="");var u=v.indexOf(e[a.dataField]);e.warehouseDestinationUuid=b[u],e.warehouseDestinationName=h[u]}if("areaName"==a.dataField){if(!w.includes(e[a.dataField].toUpperCase()))return e[a.dataField+"Status"]=!1,e[a.dataField+"Reason"]="Warehouse Area Not Found",void(e.areaSource=null);var c=w.indexOf(e[a.dataField].toUpperCase());e.areaSource=y[c],C.includes(y[c])||C.push(y[c])}if("areaNameDestination"==a.dataField){if(!w.includes(e[a.dataField].toUpperCase()))return e[a.dataField+"Status"]=!1,e[a.dataField+"Reason"]="Warehouse Area Not Found",void(e.areaDestination=null);var d=w.indexOf(e[a.dataField].toUpperCase());e.areaDestination=y[d],E.includes(y[d])||E.push(y[d])}if(S.length>0&&"outboundType"==a.dataField){if(!g.includes(e[a.dataField].toUpperCase()))return e[a.dataField+"Status"]=!1,e[a.dataField+"Reason"]="Outbound Type Not Found",void(e.outboundTypeCode=null);var m=g.indexOf(e[a.dataField].toUpperCase());e.outboundTypeCode=S[m]}if("newGrade"==a.dataField){e[a.dataField]&&!["WASTE","SEMI WASTE",""].includes(e[a.dataField].toUpperCase())?parseInt(e[a.dataField])?(k.includes(e[a.dataField])||k.push(e[a.dataField]),e[a.dataField+"Status"]=!0):""==e[a.dataField]?e[a.dataField+"Status"]=!0:(e[a.dataField+"Status"]=!1,e[a.dataField+"Reason"]="Grade Undefined"):e.newGradeUuid=e[a.dataField]}if(("ripenessLevel"==a.dataField||"newRipeness"==a.dataField)&&void 0!==e[a.dataField])e[a.dataField].split(" ")[1];var p=e[a.dataField],f=null;if("number"==a.type)isNaN(p)?f=!1:(f=!0,"wmsPoSkuCode"==a.dataField&&(N.includes(p)||N.push(p)),"skuNumber"==a.dataField&&(k.includes(p)||""===p||k.push(p)));else if("date_indo"==a.type){if(!p.match(/(0[1-9]|[12][0-9]|3[01])[-.](0[1-9]|1[012])[-.](19|20)\d\d/))return e[a.dataField+"Status"]=!1,void(e[a.dataField+"Reason"]="Date format must be 'dd-mm-yyyy'");f=!0}else f=!0;if(["grade","outboundReason","ripenessLevel","newRipeness","newGrade"].includes(a.dataField)&&""==p&&(f=!0),"newGrade"==a.dataField){["WASTE","SEMI WASTE",""].includes(p.toUpperCase())||parseInt(p)&&(f=!0,k.includes(p)||""===p||k.push(p))}e[a.dataField+"Status"]=f,e[a.dataField+"Reason"]=f?"":"Invalid ".concat(a.text," \nShould be a ").concat(a.type);var x=50*(t+1+parseInt(n.length))/(2*parseInt(n.length));s(Math.ceil(x))}})),e.emptyRow=o}));case 37:if(!(C.length>1||E.length>1)){e.next=42;break}return console.log("area Destination :"+E),console.log("area Source :"+C),p(!1),e.abrupt("return");case 42:i({type:c.l,csvData:n}),i({type:c.l,csvFileName:r}),i({type:c.l,csvDistinctPOSKUInfoId:N}),i({type:c.l,csvDistinctSKUNumber:k});case 46:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(r.a)(o.a.mark((function e(t){var a,s,r,i,u,l,d,m,p,f,v,b,h,w,y;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.poSkuInfoValidated,s=t.poSkuNumberValidated,r=t.csvData,i=t.setIsProgressPercent,u=t.dispatch,l=t.status,d=t.transaction,t.setIsProgressStatus,m=t.nextPage,!1!==l&&null!==l){e.next=3;break}return e.abrupt("return",0);case 3:if(void 0!==r&&null!==r&&null!==a&&void 0!==a&&null!==s&&void 0!==s){e.next=6;break}return console.clear(),e.abrupt("return",0);case 6:p=[],f=[],a.map((function(e){p.push(e.wmsPoSkuCode),f.push(e.uom)})),v=[],b=[],h=[],w=[],s.map((function(e){v.push(e.skuNumber),b.push(e.id),h.push(e.imageMd),w.push(e.uom)})),y=[],r.map((function(e,t){if(!0===e.emptyRow)return 0;e.areaSource=parseInt(e.areaSource),e.areaDestination=parseInt(e.areaDestination),"stock_take"!=d&&"repacking"!=d&&"outbound"!=d||(e.areaDestination=parseInt(e.areaSource),e.warehouseDestination=parseInt(e.warehouseSource));var s=p.indexOf(e.wmsPoSkuCode),o=a[s];o&&void 0!==o.isExist&&!1!==o.isExist&&null!==o.isExist?(e.inboundDate=o.inboundDate,e.uom=f[s]):(e.wmsPoSkuCodeStatus=!1,e.wmsPoSkuCodeReason="PO SKU Code Not Found");var r=e.newGrade,i=["WASTE","SEMI WASTE",""];if(void 0!==r&&!i.includes(r.toUpperCase()))if(v.includes(r)){var u=v.indexOf(r);e.newGradeStatus=!0,e.newGradeUuid=b[u]}else""==r?(e.newGradeUuid="",e.newGradeStatus=!0):(e.newGradeReason="Grade Undefined",e.newGradeStatus=!1);var l=e.skuNumber;if(v.includes(l)){var c=v.indexOf(l);e.skuUuid=b[c],e.photo=h[c]}else e.skuNumberStatus=!1,e.skuNumberReason="SKU Number Not Found",e.skuUuid="";var m=e.newGrade;if(console.log("tmp_new_grade",m),m&&i.includes(m.toUpperCase())||""==m)e.newGradeReason="",e.newGradeStatus=!0,e.newGradeUuid=null,e.newGradeUom=null;else if(v.includes(m)){var g=v.indexOf(m);e.newGradeReason="",e.newGradeStatus=!0,e.newGradeUuid=b[g],e.newGradeUom=w[g]}else e.newGradeReason="SKU Number Not Found",e.newGradeStatus=!1,e.newGradeUuid=null,e.newGradeUom=null;y.push(Object(n.a)(Object(n.a)({},e),o))})),u({type:c.l,csvData:y}),i(Math.ceil(100)),setTimeout((function(){m()}),200);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(r.a)(o.a.mark((function e(t){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.dispatch,t.resetStatus,n=t.setIsResetCsvPersist,a({type:c.l,csvData:null}),a({type:c.l,csvFileName:null}),a({type:c.l,csvDistinctPOSKUInfoId:null}),a({type:c.n,skuCodeValidated:null}),a({type:c.n,skuCodeValidated:null}),a({type:c.k,status:null}),n(!0);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},682:function(e,t,a){"use strict";var n=a(4),s=a(65),o=a.n(s),r=a(91),i=a(659),u=a(1),l=a.n(u),c=a(56),d=a(732),m=(a(690),a(677)),p=(a(691),function(e){var t=e.status,a=e.progressPercent,n=e.fileName,s=e.display,o=void 0!==s&&s,r=(e.cancelButton,e.cancelHandler);return Object(u.useEffect)((function(){}),[a,t]),l.a.createElement("div",{className:"w-100 d-flex flex-column progressBar "+(o?null:"hiddenProgress")},l.a.createElement("div",{className:"pt-3 pb-0 pl-3 pr-3 bg-white border-all radius-all mb-3 mt-0"},l.a.createElement("div",{className:"d-md-flex d-lg-flex mb-3 justify-content-between"},l.a.createElement("div",{className:"uploadStatus w-100"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-7"},l.a.createElement("i",{className:"iconU-sideBarInventoryEntry green"})," File",n),l.a.createElement("div",{className:"col-md-5"},l.a.createElement("p",{className:"float-right",style:{lineHeight:"30px",cursor:"pointer"},onClick:function(){r()}},"Cancel"))),l.a.createElement("div",{class:"progress"},l.a.createElement("div",{class:"progress-bar",role:"progressbar",style:{width:a+"%"},"aria-valuemin":"0","aria-valuemax":"100"})),l.a.createElement("div",{className:"mt-2"},l.a.createElement("div",{className:"emptyTextField inline"},t),l.a.createElement("div",{className:"text inline font-weight-bold"},"  ",a,"%"))))))}),f=a(666),v=a(662),b=a(670),h={flex:1,display:"flex",flexDirection:"column",alignItems:"center",paddingTop:"20px",paddingBottom:"20px",paddingLeft:"20px",paddingRight:"20px",outline:"none",transition:"border .24s ease-in-out",height:"400px"},w={paddingTop:"20px",paddingBottom:"10px",paddingLeft:"20px",paddingRight:"20px",borderWidth:2,borderRadius:2,borderColor:"#eeeeee",borderStyle:"dashed",backgroundColor:"#fff",outline:"none",transition:"border .24s ease-in-out",height:"600px"},y={borderColor:"#2196f3"},g={borderColor:"#00e676"},S={borderColor:"#ff1744"};t.a=function(e){var t=e.field,a=e.transaction,s=e.nextPage,x=void 0===s?null:s,N=e.type,k=void 0===N?null:N,C=l.a.useState(!1),E=Object(i.a)(C,2),O=E[0],D=E[1],F=l.a.useState(),U=Object(i.a)(F,2),j=U[0],T=U[1],I=l.a.useState(0),P=Object(i.a)(I,2),A=P[0],B=P[1],R=l.a.useState(null),L=Object(i.a)(R,2),G=L[0],W=L[1],M=l.a.useState(null),V=Object(i.a)(M,2),K=V[0],q=V[1],H=l.a.useState(null),Y=Object(i.a)(H,2),_=Y[0],X=Y[1],z=l.a.useState(null),J=Object(i.a)(z,2),Q=(J[0],J[1]),Z=l.a.useState(null),$=Object(i.a)(Z,2),ee=$[0],te=$[1],ae=l.a.useState(null),ne=Object(i.a)(ae,2),se=ne[0],oe=ne[1],re=l.a.useState(null),ie=Object(i.a)(re,2),ue=ie[0],le=ie[1],ce=l.a.useState(!1),de=Object(i.a)(ce,2),me=de[0],pe=de[1],fe=l.a.useState(0),ve=Object(i.a)(fe,2),be=(ve[0],ve[1],l.a.useState(!1)),he=Object(i.a)(be,2),we=he[0],ye=he[1],ge=l.a.useState(!1),Se=Object(i.a)(ge,2),xe=Se[0],Ne=Se[1],ke=l.a.useState(!1),Ce=Object(i.a)(ke,2),Ee=Ce[0],Oe=Ce[1],De=Object(c.c)(),Fe=Object(c.d)((function(e){return e.warehouseAreaCsv})),Ue=Object(c.d)((function(e){return e.outboundTypeCsv})),je=Object(c.d)((function(e){return e.status})),Te=(Object(c.d)((function(e){return e.uploadStatus})),Object(c.d)((function(e){return e.csvDistinctPOSKUInfoId}))),Ie=Object(c.d)((function(e){return e.csvDistinctSKUNumber})),Pe=Object(c.d)((function(e){return e.skuCodeValidated})),Ae=Object(c.d)((function(e){return e.skuNumberValidated})),Be=Object(c.d)((function(e){return e.csvData})),Re=Object(c.d)((function(e){return e.warehouseData}));!0!==me&&Object(m.d)({dispatch:De,resetStatus:me,setIsResetCsvPersist:pe});var Le=Object(c.d)((function(e){return e.user.warehouseUuid}));null===K&&(Object(b.e)({warehouseUuid:Le,dispatch:De,type:"csvValidator"}),q(1)),null===_&&"additionalOutbound"==k&&(Object(b.b)({dispatch:De,type:"csvValidator"}),X(1));var Ge=function(){var e=Object(r.a)(o.a.mark((function e(a){var n,s,r,i,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B(0),te(!0),n=a[0].name,s=n.split("."),r=s[1],i=t.map((function(e){return e.dataField})),Object(m.c)({dispatch:De,jsonArray:t}),u=null,[],e.next=11,T("Reading...");case 11:return e.next=13,W(n);case 13:return e.next=15,D(!0);case 15:if("csv"!=r){e.next=21;break}return e.next=18,Object(m.b)(a,i,B,T);case 18:u=e.sent,e.next=24;break;case 21:return e.next=23,Object(m.g)(a,i,B,T,Q,De);case 23:u=e.sent;case 24:if(console.log(u),!1!==u){e.next=28;break}return ye(!0),e.abrupt("return",0);case 28:return e.next=30,T("Validating Column Type...");case 30:return e.next=32,Object(m.f)({field:t,jsonArray:u,setIsProgressPercent:B,fileName:n,dispatch:De,warehouseArea:Fe,warehouseUuid:Le,outboundType:Ue,setIsCheckingSchema:oe,warehousesData:Re,setIsCheckingArea:le});case 32:return e.next=34,T("Validating PO SKU Code. . .");case 34:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),We=Object(d.a)({noClick:!0,onDropAccepted:Ge,accept:"text/csv,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Me=We.getRootProps,Ve=We.getInputProps,Ke=We.isDragActive,qe=We.isDragAccept,He=We.isDragReject,Ye=(We.acceptedFiles,We.open),_e=Object(u.useMemo)((function(){return Object(n.a)(Object(n.a)(Object(n.a)(Object(n.a)({},h),Ke?y:{}),qe?g:{}),He?S:{})}),[Ke,He,qe]);return Object(u.useEffect)((function(){Object(v.u)({dispatch:De,skuData:Te,status:ee})}),[Te]),Object(u.useEffect)((function(){B(70),T("Validating SKU Numbers"),Object(v.v)({dispatch:De,skuNumberData:Ie,bulk:!0,status:ee})}),[Pe]),Object(u.useEffect)((function(){B(90),T("rearrange data. . ."),Object(m.a)({poSkuInfoValidated:Pe,poSkuNumberValidated:Ae,csvData:Be,transaction:a,setIsProgressPercent:B,dispatch:De,status:ee,setIsProgressStatus:T,nextPage:x})}),[Ae]),Object(u.useEffect)((function(){!1===se&&(console.log(se),Ne(!0),oe(null))}),[se]),Object(u.useEffect)((function(){!1===ue&&(console.log(ue),Oe(!0),le(null))}),[ue]),l.a.createElement("div",null,l.a.createElement(f.a,{status:je,onCloseFunction:function(){ye(!1),B(0),D(!1)},statusDisplay:we,title:"Upload File Failed",cancelButtonTitle:"Try Another File",actionButtonTitle:null,colorText:"red",refreshOnCancel:!1,msg1:l.a.createElement("div",null,l.a.createElement("div",null,"Upload failed because your file has more than 2000 lines."," "),l.a.createElement("div",null," Please make it less than 2000 lines. ")),msg2:"Do you want to try another file?",cancelButtonClass:"bg-red background",actionButtonClass:" "}),l.a.createElement(f.a,{status:200,onCloseFunction:function(){Ne(!1),B(0),D(!1)},actionButtonEvent:function(){return Object(m.e)()},statusDisplay:xe,title:"Different File Template",cancelButtonTitle:"Cancel",actionButtonTitle:"Download latest template",colorText:"red",refreshOnCancel:!1,msg1:l.a.createElement("div",null,l.a.createElement("div",null," Your uploaded file has a different template.")),msg2:"Do you want to download the latest file template ?",actionButtonClass:"bg-green background",cancelButtonClass:""}),l.a.createElement(f.a,{status:200,onCloseFunction:function(){Oe(!1),B(0),D(!1)},actionButtonEvent:function(){Oe(!1),B(0),D(!1)},statusDisplay:Ee,title:"Upload File Failed!",actionButtonTitle:"Try Another File",colorText:"red",refreshOnCancel:!1,msg1:l.a.createElement("div",null,l.a.createElement("div",null," ","We detect that you've uploaded two or more areas at once."),l.a.createElement("div",null," ","Please try again to upload the file with one specific area.")),msg2:"Do you want to try another file ?",actionButtonClass:"bg-red margin-left-0 background",cancelButtonClass:"d-none "}),l.a.createElement("div",{className:"w-100 d-flex flex-column p-3 mb-3 bg-white"},l.a.createElement("div",{className:"d-flex flex-column justify-content-between",style:w},l.a.createElement("div",{className:"FileUploader"},l.a.createElement("div",Object.assign({className:"d-flex flex-column justify-content-end"},Me({style:_e})),l.a.createElement("input",Ve()),l.a.createElement("i",{style:{fontSize:"90px"},className:"lineGrey iconU-upload"}),l.a.createElement("b",{className:"mt-2"},"Drag and Drop files here"),l.a.createElement("p",{className:"mt-2 mb-2 emptyTextField"}," Or "),l.a.createElement("button",{type:"button",onClick:Ye,className:"btn px-5 py-2 text-white bg-green LatoBold no-shadow"},"Browse File"),l.a.createElement("div",{className:"emptyTextField LatoBold mt-3 "},"Support only CSV, XLS, XLSX file"))),l.a.createElement("div",{className:"downloadTemplate w-100 align-right"},l.a.createElement("span",{onClick:function(){return Object(m.e)()},className:"float-right"},"Download the File Template")))),l.a.createElement(p,{status:j,progressPercent:A,fileName:G,display:O,cancelHandler:function(){window.location.reload()}}))}},683:function(e,t,a){"use strict";a.d(t,"b",(function(){return g})),a.d(t,"a",(function(){return y}));var n=a(65),s=a.n(n),o=a(91),r=a(169),i=a(170),u=a(172),l=a(171),c=a(1),d=a.n(c),m=a(660),p=a(725),f=a.n(p),v=(a(56),a(677),a(692),a(726),a(662),a(47)),b=a.n(v),h=a(727),w=a.n(h),y=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).changeWarehouseUuid=function(e,t,a,r,i,u,l){var c=n.props,d=c.setCsvDataTmp,m=c.globalData,p=m.findIndex((function(e){return e.id==r})),f=i.indexOf(e);m[p][t]=u[f],m[p][a]=l[f],setTimeout(Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d(m);case 1:case"end":return e.stop()}}),e)}))),400)},n.validatePOSKU=function(){var e=Object(o.a)(s.a.mark((function e(t,a,r){var i,u,l,c,d,m,p;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=n.props,u=i.setCsvDataTmp,l=i.globalData,c=i.setIsValidate,d=l,e.prev=2,c(!1),"/stocktake/rowValidationUpload",m=null,p=null,setTimeout(Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m=document.getElementById("".concat(r)),p=document.getElementById("".concat(r,"span")),null!==m&&void 0!==m){e.next=4;break}return e.abrupt("return",0);case 4:return p.innerHTML="Validating",e.next=7,b()({method:"post",url:"/stocktake/rowValidationUpload",data:{data:[t]}}).then((function(e){var t,n=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data,s=d.findIndex((function(e){return e.id==a}));n[0]&&!0===n[0].isExist?(d[s].wmsPoSkuCode=n[0].wmsPoSkuCode,d[s].wmsPoSkuCodeStatus=!0,d[s].wmsPoSkuCodeReason="PO SKU Code Not Found",d[s].expiryDate=n[0].expiryDate,d[s].inboundDate=n[0].inboundDate,d[s].supplierName=n[0].supplierName,d[s].supplierUuid=n[0].supplierUuid,d[s].uom=n[0].uom,d[s].photos=n[0].photos,m.classList.remove("red"),m.classList.add("hiddenTooltip")):(d[s].wmsPoSkuCodeStatus=!1,d[s].wmsPoSkuCodeReason="PO SKU Code Not Found",d[s].expiryDate="",d[s].inboundDate="",d[s].supplierName="",d[s].supplierUuid="",m.classList.add("red"),m.classList.remove("hiddenTooltip"),p.innerHTML="PO SKU Code Not Found"),u(d)}));case 7:case"end":return e.stop()}}),e)}))),400),e.next=13;break;case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,a,n){return e.apply(this,arguments)}}(),n.validateOutbountReason=function(e,t,a){var s=n.props.globalData,o=s.findIndex((function(e){return e.id==t})),r=s[o];""==e&&"LAINNYA"==r.outboundType.toUpperCase()&&setTimeout((function(){var e=document.getElementById("row".concat(t,"-outboundReason"));e.classList.add("red","tooltip-custom"),e.innerHTML="Outbound Reason Can't be empty<span class=\"tooltiptext\">Outbound Reason Can't be empty if Outbound type = 'Lainnya'</span>"}),300)},n.validateOutbountType=function(e,t,a){var s=n.props,o=s.globalData,r=(s.setCsvDataTmp,s.setIsValidate),i=o;if(r(!1),"LAINNYA"!==e.toUpperCase())return r(!0),0;var u=i.findIndex((function(e){return e.id==t}));""==i[u].outboundReason&&setTimeout((function(){var e=document.getElementById("row".concat(t,"-outboundReason"));e.classList.add("red","tooltip-custom"),e.innerHTML="Outbound Reason Can't be empty<span class=\"tooltiptext\">Outbound Reason Can't be empty if Outbound type = 'Lainnya'</span>"}),300)},n.validateSKUNumber=function(){var e=Object(o.a)(s.a.mark((function e(t,a,r,i){var u,l,c,d,m,p,f;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=n.props,l=u.globalData,c=u.setCsvDataTmp,d=u.setIsValidate,m=l,e.prev=2,d(!1),"/oss/skuByNumbers",p=null,f=null,setTimeout(Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p=document.getElementById("".concat(r)),f=document.getElementById("".concat(r,"span")),null!==p&&void 0!==p){e.next=4;break}return e.abrupt("return",0);case 4:return f.innerHTML="Validating",e.next=7,b()({method:"post",url:"/oss/skuByNumbers",data:{skuList:[t]}}).then((function(e){var n,s=null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.data,o=e.data.isSuccess,r=m.findIndex((function(e){return e.id==a}));!0===o&&s.length>0?(m[r][i]=s[0].skuNumber,m[r][i+"Reason"]=s[0].skuDescription,m[r][i+"Status"]=!0,m[r][i+"Uuid"]=s[0].id,p.classList.remove("red"),p.classList.add("hiddenTooltip"),"skuNumber"==i&&(m[r].skuUuid=s[0].id,m[r].photo=s[0].imageMd),"newGrade"==i&&(m[r].newGradeUom=s[0].uom)):(m[r][i]=t,m[r][i+"Reason"]="SKU Number Not Found",m[r][i+"Status"]=!1,m[r][i+"Uuid"]=null,p.classList.add("red"),p.classList.remove("hiddenTooltip"),f.innerHTML="SKU Number Not Found","skuNumber"==i&&(m[r].skuUuid="",m[r].photo=""),"newGrade"==i&&(m[r].newGradeUom=null)),c(m)}));case 7:case"end":return e.stop()}}),e)}))),400),e.next=13;break;case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,a,n,s){return e.apply(this,arguments)}}(),n.state={validateStatus:!1,validateResult:"Please Wait...",rowCount:0,keyy:0},n}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.columns,n=(t.defaultSorted,t.hiddenRows),s=t.tableClass,o=t.warehouseArea,r=t.outboundType,i=(t.setIsValidate,t.setCheckingCsv),u=t.globalData,l=t.editable,c=void 0===l||l,p=t.warehousesData,v=void 0===p?[]:p,b=this.state,h=(b.validateStatus,b.rowCount,b.keyy);var y=[],g=[],S=[];if(v){var x;null===v||void 0===v||null===(x=v.data)||void 0===x||x.map((function(e){y.push(e.code),g.push(e.id),S.push(e.name)}))}var N=o.map((function(e){return e.label.toUpperCase()}))||[],k=o.map((function(e){return e.value}))||[],C=r?r.map((function(e){return e.label.toUpperCase()})):[],E=r?r.map((function(e){return e.value})):[],O=a.map((function(t,a){return t.validator=function(a,n,s,o){var r=t.dataField,u=r+"Status",l=r+"Reason",c=!0,d=null,m="row"+n.id+"-"+r;"wmsPoSkuCode"==r&&(e.validatePOSKU(a,n.id,m,r),c=!0),"skuNumber"==r&&(e.validateSKUNumber(a,n.id,m,r),c=!0);var p=["WASTE","SEMI WASTE"];if("newGrade"==r&&"waste"==e.props.transaction?p.includes(a.toUpperCase())?(n.newGradeUuid=a,n.newGradeUom=null):(d="Waste Type not found",b=!1,c=!1):"newGrade"==r&&(p.includes(a.toUpperCase())?(n.newGradeUuid=a,n.newGradeUom=null):parseInt(a)?(c=!0,e.validateSKUNumber(a,n.id,m,r)):""==a?(n.newGradeUuid=null,n.newGradeUom=null,c=!0):(d="Grade Undefined",b=!1,c=!1)),"outboundType"==r&&E.length>0)if(C.includes(a.toUpperCase())){var f=C.indexOf(a.toUpperCase());n.outboundTypeCode=E[f],c=!0,e.validateOutbountType(a,n.id,m)}else c=!1,d="Outbound Type Not Found";if("outboundReason"==r&&e.validateOutbountReason(a,n.id,m),"warehouse"==r&&(y.includes(a)?e.changeWarehouseUuid(a,"warehouseUuid","warehouseName",n.id,y,g,S):(c=!1,d="Warehouse Not Found")),"warehouseDestination"==r&&(y.includes(a)?e.changeWarehouseUuid(a,"warehouseDestinationUuid","warehouseDestinationName",n.id,y,g,S):(c=!1,d="Warehouse Not Found")),"areaName"==r||"areaNameDestination"==r)if(N.includes(a.toUpperCase())){var v=N.indexOf(a.toUpperCase());"areaNameDestination"==r?n.areaDestination=k[v]:n.areaSource=k[v],c=!0}else c=!1,d="Warehouse Area Not Found";"newPack"==r&&(!isNaN(a)?c=!0:(c=!1,d="Pack Should be a number"));var b=null;!1===(b="number"!=t.type||!isNaN(a))&&(d="".concat(t.text," Should be a ").concat(t.type));if(["grade","outboundReason","ripenessLevel","newRipeness","reason","expiryDate"].includes(r)&&""===a)d="",b=!0,c=!0;else if("grade"==r){["WASTE","SEMI WASTE"].includes(a.toUpperCase())||(d="Waste Type Not Found",b=!1,c=!1)}if("ripenessLevel"==r||"newRipeness"==r){[0,1,2,3].includes(parseInt(a))||""==a?(b=!0,c=!0,d="",""==a&&(a="")):(b=!1,c=!1,d="Undefined Ripeness Level")}if("date_indo"==t.type){a.match(/(0[1-9]|[12][0-9]|3[01])[-.](0[1-9]|1[012])[-.](19|20)\d\d/)||""==a?(b=!0,c=!0):(d="Date format must be 'dd-mm-yyyy'",b=!1,c=!1)}if(n[l]=d,c&&b){["wmsPoSkuCode","skuNumber"].includes(r)||(n[u]=!0,i())}return{valid:!(!c||!b),message:d}},t.formatter=function(e,a,n){var s=t.dataField,o=s+"Status",r=s+"Reason",i="row"+a.id+"-"+s,u=a[r];return!1===a[o]?(!1,!1,d.a.createElement("div",{id:i,className:"tooltip-custom red"},e,d.a.createElement("span",{id:i+"span",className:"tooltiptext"},u))):d.a.createElement("div",{id:i,className:"tooltip-custom hiddenTooltip"},e,d.a.createElement("span",{id:i+"span",className:"tooltiptext"},u))},t})),D={sortFunc:this.sortFunc,sortCaret:function(e,t){return e?"asc"===e?d.a.createElement("i",{className:"iconU-tableSortingTop ml-2"}):"desc"===e?d.a.createElement("i",{className:"iconU-tableSortingBottom ml-2"}):null:d.a.createElement("i",{className:"iconU-tableSortingNull ml-2"})}};return console.clear(),console.log(u),d.a.createElement(m.e,{className:"table-responsive"},d.a.createElement(f.a,{keyField:"id",data:u,columns:O,sort:D,classes:s||null,cellEdit:!0===c?w()({mode:"click",blurToSave:!0}):null,bordered:!1,hiddenRows:n,key:h}))}}]),a}(d.a.Component),g=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.columns,a=e.tableClass,n=e.data,s=t.map((function(e,t){return e.formatter=function(t,a,n){var s=e.dataField;return"uploadStatus"==s&&"Failed"===a.uploadStatus?d.a.createElement("div",{className:"tooltip-custom red"},t,d.a.createElement("span",{className:"tooltiptext"},a.uploadStatusReason)):"uploadStatus"==s&&"Success"===a.uploadStatus?d.a.createElement("div",{className:"green"},t,d.a.createElement("span",null)):d.a.createElement("div",null,t,d.a.createElement("span",null))},e})),o={sortFunc:this.sortFunc,sortCaret:function(e,t){return e?"asc"===e?d.a.createElement("i",{className:"iconU-tableSortingTop ml-2"}):"desc"===e?d.a.createElement("i",{className:"iconU-tableSortingBottom ml-2"}):null:d.a.createElement("i",{className:"iconU-tableSortingNull ml-2"})}};return d.a.createElement(m.e,{className:"table-responsive"},d.a.createElement(f.a,{keyField:"id",data:n,columns:s,sort:o,classes:a||null,bordered:!1}))}}]),a}(d.a.Component)},690:function(e,t,a){},691:function(e,t,a){},692:function(e,t,a){},703:function(e,t){},706:function(e,t){},707:function(e,t){},709:function(e,t){},710:function(e,t){},731:function(e,t,a){}}]);
//# sourceMappingURL=33.c7c34f61.chunk.js.map