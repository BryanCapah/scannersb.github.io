(this["webpackJsonp@coreui/coreui-pro-react-admin-template"]=this["webpackJsonp@coreui/coreui-pro-react-admin-template"]||[]).push([[10],{679:function(e,t,a){"use strict";a.d(t,"e",(function(){return c})),a.d(t,"b",(function(){return p})),a.d(t,"g",(function(){return m})),a.d(t,"c",(function(){return f})),a.d(t,"f",(function(){return v})),a.d(t,"a",(function(){return b})),a.d(t,"d",(function(){return S}));var n=a(5),r=a(65),o=a.n(r),u=a(91),s=a(728),i=a.n(s),d=a(731),l=a(21),c=function(){document.getElementById("download-template-xls").click()},p=function(e,t,a){return new Promise((function(n,r){var o=0,u=[],s=new FileReader;s.onload=function(){i.a.parse(s.result,(function(e,r){r.length>2001&&(a(0),n(!1)),r.map((function(e,n){if(0===n)return o++,!1;var s={};s.id=n,r[o].toString().split(";").map((function(e,a){s[t[a+1]]=e})),o++,u.push(s);var i=25*(n+1)/r.length;a(Math.ceil(i))}))}))},setTimeout((function(){n(u)}),200),s.readAsBinaryString(e[0])}))},m=function(){var e=Object(u.a)(o.a.mark((function e(t,a,n,r,s){var l,c,p,m;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=0,c=[],p=new FileReader,m=null,!1,e.abrupt("return",new Promise((function(e,r){new FileReader;p.onload=function(){var t=Object(u.a)(o.a.mark((function t(r){var u,s,p,f;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=r.target.result,s=d.read(u,{type:"binary"}),p=s.SheetNames[0],f=s.Sheets[p],m=d.utils.sheet_to_csv(f,{header:1}),t.next=7,i.a.parse(m,(function(t,r){r.length>2001&&(n(0),e(!1)),r.map((function(e,t){var o={};o.id=t,r[l].toString().split(",").map((function(e,t){o[a[t+1]]=e})),l++,c.push(o);var u=25*(t+1)/r.length;n(Math.ceil(u))}))}));case 7:setTimeout((function(){e(c)}),200);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),p.readAsBinaryString(t[0])})));case 6:case"end":return e.stop()}}),e)})));return function(t,a,n,r,o){return e.apply(this,arguments)}}(),f=function(e){var t=e.dispatch,a=e.jsonArray;t({type:l.l,csvField:a})},v=function(){var e=Object(u.a)(o.a.mark((function e(t){var a,n,r,u,s,i,d,c,p,m,f,v,b,S,h,w,y,U,k,N;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.field,n=t.jsonArray,r=t.setIsProgressPercent,u=t.fileName,s=t.dispatch,i=t.warehouseArea,d=t.warehouseUuid,c=t.outboundType,p=t.setIsCheckingSchema,m=i?i.map((function(e){return e.label.toUpperCase()})):[],f=i?i.map((function(e){return e.value})):[],v=c?c.map((function(e){return e.label.toUpperCase()})):[],b=c?c.map((function(e){return e.value})):[],S=a?a.map((function(e){return e.text.toUpperCase().replace(/\s/g,"")})):[],h=[],w=[],!0,y=0,U=n[0],e.t0=o.a.keys(U);case 12:if((e.t1=e.t0()).done){e.next=28;break}if("id"!=(k=e.t1.value)){e.next=16;break}return e.abrupt("continue",12);case 16:if(N=U[k].toUpperCase().replace(/\s/g,""),"undefined"===k||S[y+1]===N&&S.includes(N)){e.next=25;break}return console.clear(),console.log("--Schema Not Same--"),console.log("Schema \t\t: ",S[y+1]),console.log("File SChema : ",N),!1,p(!1),e.abrupt("return",0);case 25:y++,e.next=12;break;case 28:return n.shift(),e.next=31,n.map((function(e,t){var o=!0;a.map((function(a,u){if(void 0!==a&&null!==a&&("id"===a.dataField||""!=e[a.dataField])){if("id"==a.dataField||(o=!1),e.warehouseSource=d,"areaName"==a.dataField){if(!m.includes(e[a.dataField].toUpperCase()))return e[a.dataField+"Status"]=!1,e[a.dataField+"Reason"]="Warehouse Area Not Found",void(e.areaSource=null);var s=m.indexOf(e[a.dataField].toUpperCase());e.areaSource=f[s]}if("areaNameDestination"==a.dataField){if(!m.includes(e[a.dataField].toUpperCase()))return e[a.dataField+"Status"]=!1,e[a.dataField+"Reason"]="Warehouse Area Not Found",void(e.areaDestination=null);var i=m.indexOf(e[a.dataField].toUpperCase());e.areaDestination=f[i]}if(b.length>0&&"outboundType"==a.dataField){if(!v.includes(e[a.dataField].toUpperCase()))return e[a.dataField+"Status"]=!1,e[a.dataField+"Reason"]="Outbound Type Not Found",void(e.outboundTypeCode=null);var l=v.indexOf(e[a.dataField].toUpperCase());e.outboundTypeCode=b[l]}if("newGrade"==a.dataField){e[a.dataField]&&!["WASTE","SEMI WASTE",""].includes(e[a.dataField].toUpperCase())?parseInt(e[a.dataField])?(w.includes(e[a.dataField])||w.push(e[a.dataField]),e[a.dataField+"Status"]=!0):""==e[a.dataField]?e[a.dataField+"Status"]=!0:(e[a.dataField+"Status"]=!1,e[a.dataField+"Reason"]="Grade Undefined"):e.newGradeUuid=e[a.dataField]}if(("ripenessLevel"==a.dataField||"newRipeness"==a.dataField)&&void 0!==e[a.dataField])e[a.dataField].split(" ")[1];var c=e[a.dataField],p=null;if("number"==a.type)isNaN(c)?p=!1:(p=!0,"wmsPoSkuCode"==a.dataField&&(h.includes(c)||h.push(c)),"skuNumber"==a.dataField&&(w.includes(c)||""===c||w.push(c)));else if("date_indo"==a.type){if(!c.match(/(0[1-9]|[12][0-9]|3[01])[-.](0[1-9]|1[012])[-.](19|20)\d\d/))return e[a.dataField+"Status"]=!1,void(e[a.dataField+"Reason"]="Date format must be 'dd-mm-yyyy'");p=!0}else p=!0;if(["grade","outboundReason","ripenessLevel","newRipeness","newGrade"].includes(a.dataField)&&""==c&&(p=!0),"newGrade"==a.dataField){["WASTE","SEMI WASTE",""].includes(c.toUpperCase())||parseInt(c)&&(p=!0,w.includes(c)||""===c||w.push(c))}e[a.dataField+"Status"]=p,e[a.dataField+"Reason"]=p?"":"Invalid ".concat(a.text," \nShould be a ").concat(a.type);var S=50*(t+1+parseInt(n.length))/(2*parseInt(n.length));r(Math.ceil(S))}})),e.emptyRow=o}));case 31:s({type:l.l,csvData:n}),s({type:l.l,csvFileName:u}),s({type:l.l,csvDistinctPOSKUInfoId:h}),s({type:l.l,csvDistinctSKUNumber:w});case 35:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(u.a)(o.a.mark((function e(t){var a,r,u,s,i,d,c,p,m,f,v,b,S,h,w;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.poSkuInfoValidated,r=t.poSkuNumberValidated,u=t.csvData,s=t.setIsProgressPercent,i=t.dispatch,d=t.status,c=t.transaction,t.setIsProgressStatus,p=t.nextPage,!1!==d&&null!==d){e.next=3;break}return e.abrupt("return",0);case 3:if(void 0!==u&&null!==u&&null!==a&&void 0!==a&&null!==r&&void 0!==r){e.next=6;break}return console.clear(),e.abrupt("return",0);case 6:m=[],f=[],a.map((function(e){m.push(e.wmsPoSkuCode),f.push(e.uom)})),v=[],b=[],S=[],h=[],r.map((function(e){v.push(e.skuNumber),b.push(e.id),S.push(e.imageMd),h.push(e.uom)})),w=[],u.map((function(e,t){if(!0===e.emptyRow)return 0;e.areaSource=parseInt(e.areaSource),e.areaDestination=parseInt(e.areaDestination),"stock_take"!=c&&"repacking"!=c&&"outbound"!=c||(e.areaDestination=parseInt(e.areaSource),e.warehouseDestination=parseInt(e.warehouseSource));var r=m.indexOf(e.wmsPoSkuCode),o=a[r];o&&void 0!==o.isExist&&!1!==o.isExist&&null!==o.isExist?(e.inboundDate=o.inboundDate,e.uom=f[r]):(e.wmsPoSkuCodeStatus=!1,e.wmsPoSkuCodeReason="PO SKU Code Not Found");var u=e.newGrade,s=["WASTE","SEMI WASTE",""];if(void 0!==u&&!s.includes(u.toUpperCase()))if(v.includes(u)){var i=v.indexOf(u);e.newGradeStatus=!0,e.newGradeUuid=b[i]}else""==u?(e.newGradeUuid="",e.newGradeStatus=!0):(e.newGradeReason="Grade Undefined",e.newGradeStatus=!1);var d=e.skuNumber;if(v.includes(d)){var l=v.indexOf(d);e.skuUuid=b[l],e.photo=S[l]}else e.skuNumberStatus=!1,e.skuNumberReason="SKU Number Not Found",e.skuUuid="";var p=e.newGrade;if(console.log("tmp_new_grade",p),p&&s.includes(p.toUpperCase())||""==p)e.newGradeReason="",e.newGradeStatus=!0,e.newGradeUuid=null,e.newGradeUom=null;else if(v.includes(p)){var y=v.indexOf(p);e.newGradeReason="",e.newGradeStatus=!0,e.newGradeUuid=b[y],e.newGradeUom=h[y]}else e.newGradeReason="SKU Number Not Found",e.newGradeStatus=!1,e.newGradeUuid=null,e.newGradeUom=null;w.push(Object(n.a)(Object(n.a)({},e),o))})),i({type:l.l,csvData:w}),s(Math.ceil(100)),setTimeout((function(){p()}),200);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(u.a)(o.a.mark((function e(t){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.dispatch,t.resetStatus,n=t.setIsResetCsvPersist,a({type:l.l,csvData:null}),a({type:l.l,csvFileName:null}),a({type:l.l,csvDistinctPOSKUInfoId:null}),a({type:l.n,skuCodeValidated:null}),a({type:l.n,skuCodeValidated:null}),a({type:l.k,status:null}),n(!0);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},709:function(e,t,a){"use strict";a.d(t,"b",(function(){return y})),a.d(t,"a",(function(){return w}));var n=a(65),r=a.n(n),o=a(91),u=a(169),s=a(170),i=a(172),d=a(171),l=a(1),c=a.n(l),p=a(665),m=a(734),f=a.n(m),v=(a(679),a(771),a(772),a(663),a(53)),b=a.n(v),S=a(773),h=a.n(S),w=function(e){Object(i.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).validatePOSKU=function(){var e=Object(o.a)(r.a.mark((function e(t,a,u){var s,i,d,l,c,p,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=n.props,i=s.setCsvDataTmp,d=s.globalData,l=s.setIsValidate,c=d,e.prev=2,l(!1),"/stocktake/rowValidationUpload",p=null,m=null,setTimeout(Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p=document.getElementById("".concat(u)),m=document.getElementById("".concat(u,"span")),null!==p&&void 0!==p){e.next=4;break}return e.abrupt("return",0);case 4:return m.innerHTML="Validating",e.next=7,b()({method:"post",url:"/stocktake/rowValidationUpload",data:{data:[t]}}).then((function(e){var t,n=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data,r=c.findIndex((function(e){return e.id==a}));n[0]&&!0===n[0].isExist?(c[r].wmsPoSkuCode=n[0].wmsPoSkuCode,c[r].wmsPoSkuCodeStatus=!0,c[r].wmsPoSkuCodeReason="PO SKU Code Not Found",c[r].expiryDate=n[0].expiryDate,c[r].inboundDate=n[0].inboundDate,c[r].supplierName=n[0].supplierName,c[r].supplierUuid=n[0].supplierUuid,c[r].uom=n[0].uom,c[r].photos=n[0].photos,p.classList.remove("red"),p.classList.add("hiddenTooltip")):(c[r].wmsPoSkuCodeStatus=!1,c[r].wmsPoSkuCodeReason="PO SKU Code Not Found",c[r].expiryDate="",c[r].inboundDate="",c[r].supplierName="",c[r].supplierUuid="",p.classList.add("red"),p.classList.remove("hiddenTooltip"),m.innerHTML="PO SKU Code Not Found"),i(c)}));case 7:case"end":return e.stop()}}),e)}))),400),e.next=13;break;case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,a,n){return e.apply(this,arguments)}}(),n.validateOutbountReason=function(e,t,a){var r=n.props.globalData,o=r.findIndex((function(e){return e.id==t})),u=r[o];""==e&&"LAINNYA"==u.outboundType.toUpperCase()&&setTimeout((function(){var e=document.getElementById("row".concat(t,"-outboundReason"));e.classList.add("red","tooltip-custom"),e.innerHTML="Outbound Reason Can't be empty<span class=\"tooltiptext\">Outbound Reason Can't be empty if Outbound type = 'Lainnya'</span>"}),300)},n.validateOutbountType=function(e,t,a){var r=n.props,o=r.globalData,u=(r.setCsvDataTmp,r.setIsValidate),s=o;if(u(!1),"LAINNYA"!==e.toUpperCase())return u(!0),0;var i=s.findIndex((function(e){return e.id==t}));""==s[i].outboundReason&&setTimeout((function(){var e=document.getElementById("row".concat(t,"-outboundReason"));e.classList.add("red","tooltip-custom"),e.innerHTML="Outbound Reason Can't be empty<span class=\"tooltiptext\">Outbound Reason Can't be empty if Outbound type = 'Lainnya'</span>"}),300)},n.validateSKUNumber=function(){var e=Object(o.a)(r.a.mark((function e(t,a,u,s){var i,d,l,c,p,m,f;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=n.props,d=i.globalData,l=i.setCsvDataTmp,c=i.setIsValidate,p=d,e.prev=2,c(!1),"/oss/skuByNumbers",m=null,f=null,setTimeout(Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m=document.getElementById("".concat(u)),f=document.getElementById("".concat(u,"span")),null!==m&&void 0!==m){e.next=4;break}return e.abrupt("return",0);case 4:return f.innerHTML="Validating",e.next=7,b()({method:"post",url:"/oss/skuByNumbers",data:{skuList:[t]}}).then((function(e){var n,r=null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.data,o=e.data.isSuccess,u=p.findIndex((function(e){return e.id==a}));!0===o&&r.length>0?(p[u][s]=r[0].skuNumber,p[u][s+"Reason"]=r[0].skuDescription,p[u][s+"Status"]=!0,p[u][s+"Uuid"]=r[0].id,m.classList.remove("red"),m.classList.add("hiddenTooltip"),"skuNumber"==s&&(p[u].skuUuid=r[0].id,p[u].photo=r[0].imageMd),"newGrade"==s&&(p[u].newGradeUom=r[0].uom)):(p[u][s]=t,p[u][s+"Reason"]="SKU Number Not Found",p[u][s+"Status"]=!1,p[u][s+"Uuid"]=null,m.classList.add("red"),m.classList.remove("hiddenTooltip"),f.innerHTML="SKU Number Not Found","skuNumber"==s&&(p[u].skuUuid="",p[u].photo=""),"newGrade"==s&&(p[u].newGradeUom=null)),l(p)}));case 7:case"end":return e.stop()}}),e)}))),400),e.next=13;break;case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,a,n,r){return e.apply(this,arguments)}}(),n.state={validateStatus:!1,validateResult:"Please Wait...",rowCount:0,keyy:0},n}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.columns,n=(t.defaultSorted,t.hiddenRows),r=t.tableClass,o=t.warehouseArea,u=t.outboundType,s=(t.setIsValidate,t.setCheckingCsv),i=t.globalData,d=t.editable,l=void 0===d||d,m=this.state,v=(m.validateStatus,m.rowCount,m.keyy);var b=o.map((function(e){return e.label.toUpperCase()}))||[],S=o.map((function(e){return e.value}))||[],w=u?u.map((function(e){return e.label.toUpperCase()})):[],y=u?u.map((function(e){return e.value})):[],U=a.map((function(t,a){return t.validator=function(a,n,r,o){var u=t.dataField,i=u+"Status",d=u+"Reason",l=!0,c=null,p="row"+n.id+"-"+u;"wmsPoSkuCode"==u&&(e.validatePOSKU(a,n.id,p,u),l=!0),"skuNumber"==u&&(e.validateSKUNumber(a,n.id,p,u),l=!0);var m=["WASTE","SEMI WASTE"];if("newGrade"==u&&"waste"==e.props.transaction?m.includes(a.toUpperCase())?(n.newGradeUuid=a,n.newGradeUom=null):(c="Waste Type not found",h=!1,l=!1):"newGrade"==u&&(m.includes(a.toUpperCase())?(n.newGradeUuid=a,n.newGradeUom=null):parseInt(a)?(l=!0,e.validateSKUNumber(a,n.id,p,u)):""==a?(n.newGradeUuid=null,n.newGradeUom=null,l=!0):(c="Grade Undefined",h=!1,l=!1)),"outboundType"==u&&y.length>0)if(w.includes(a.toUpperCase())){var f=w.indexOf(a.toUpperCase());n.outboundTypeCode=y[f],l=!0,e.validateOutbountType(a,n.id,p)}else l=!1,c="Outbound Type Not Found";if("outboundReason"==u&&e.validateOutbountReason(a,n.id,p),"areaName"==u||"areaNameDestination"==u)if(b.includes(a.toUpperCase())){var v=b.indexOf(a.toUpperCase());"areaNameDestination"==u?n.areaDestination=S[v]:n.areaSource=S[v],l=!0}else l=!1,c="Warehouse Area Not Found";"newPack"==u&&(!isNaN(a)?l=!0:(l=!1,c="Pack Should be a number"));var h=null;!1===(h="number"!=t.type||!isNaN(a))&&(c="".concat(t.text," Should be a ").concat(t.type));if(["grade","outboundReason","ripenessLevel","newRipeness","reason","expiryDate"].includes(u)&&""===a)c="",h=!0,l=!0;else if("grade"==u){["WASTE","SEMI WASTE"].includes(a.toUpperCase())||(c="Waste Type Not Found",h=!1,l=!1)}if("ripenessLevel"==u||"newRipeness"==u){[0,1,2,3].includes(parseInt(a))||""==a?(h=!0,l=!0,c="",""==a&&(a="")):(h=!1,l=!1,c="Undefined Ripeness Level")}if("date_indo"==t.type){a.match(/(0[1-9]|[12][0-9]|3[01])[-.](0[1-9]|1[012])[-.](19|20)\d\d/)||""==a?(h=!0,l=!0):(c="Date format must be 'dd-mm-yyyy'",h=!1,l=!1)}if(n[d]=c,l&&h){["wmsPoSkuCode","skuNumber"].includes(u)||(n[i]=!0,s())}return{valid:!(!l||!h),message:c}},t.formatter=function(e,a,n){var r=t.dataField,o=r+"Status",u=r+"Reason",s="row"+a.id+"-"+r,i=a[u];return!1===a[o]?(!1,!1,c.a.createElement("div",{id:s,className:"tooltip-custom red"},e,c.a.createElement("span",{id:s+"span",className:"tooltiptext"},i))):c.a.createElement("div",{id:s,className:"tooltip-custom hiddenTooltip"},e,c.a.createElement("span",{id:s+"span",className:"tooltiptext"},i))},t})),k={sortFunc:this.sortFunc,sortCaret:function(e,t){return e?"asc"===e?c.a.createElement("i",{className:"iconU-tableSortingTop ml-2"}):"desc"===e?c.a.createElement("i",{className:"iconU-tableSortingBottom ml-2"}):null:c.a.createElement("i",{className:"iconU-tableSortingNull ml-2"})}};return console.clear(),console.log(i),c.a.createElement(p.e,{className:"table-responsive"},c.a.createElement(f.a,{keyField:"id",data:i,columns:U,sort:k,classes:r||null,cellEdit:!0===l?h()({mode:"click",blurToSave:!0}):null,bordered:!1,hiddenRows:n,key:v}))}}]),a}(c.a.Component),y=function(e){Object(i.a)(a,e);var t=Object(d.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.columns,a=e.tableClass,n=e.data,r=t.map((function(e,t){return e.formatter=function(t,a,n){var r=e.dataField;return"uploadStatus"==r&&"Failed"===a.uploadStatus?c.a.createElement("div",{className:"tooltip-custom red"},t,c.a.createElement("span",{className:"tooltiptext"},a.uploadStatusReason)):"uploadStatus"==r&&"Success"===a.uploadStatus?c.a.createElement("div",{className:"green"},t,c.a.createElement("span",null)):c.a.createElement("div",null,t,c.a.createElement("span",null))},e})),o={sortFunc:this.sortFunc,sortCaret:function(e,t){return e?"asc"===e?c.a.createElement("i",{className:"iconU-tableSortingTop ml-2"}):"desc"===e?c.a.createElement("i",{className:"iconU-tableSortingBottom ml-2"}):null:c.a.createElement("i",{className:"iconU-tableSortingNull ml-2"})}};return c.a.createElement(p.e,{className:"table-responsive"},c.a.createElement(f.a,{keyField:"id",data:n,columns:r,sort:o,classes:a||null,bordered:!1}))}}]),a}(c.a.Component)},723:function(e,t){},729:function(e,t){},730:function(e,t){},732:function(e,t){},733:function(e,t){},771:function(e,t,a){}}]);
//# sourceMappingURL=10.945474a8.chunk.js.map